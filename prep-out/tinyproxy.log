Command: /itch/common/crepos/tcc-scripts/tidy-braces.sh
Directory: /itch/common/crepos/cu-to-rtu/c/tinyproxy
----------------------------------------

Enabled checks:
    clang-analyzer-apiModeling.Errno
    clang-analyzer-apiModeling.TrustNonnull
    clang-analyzer-apiModeling.TrustReturnsNonnull
    clang-analyzer-apiModeling.google.GTest
    clang-analyzer-apiModeling.llvm.CastValue
    clang-analyzer-apiModeling.llvm.ReturnValue
    clang-analyzer-core.BitwiseShift
    clang-analyzer-core.CallAndMessage
    clang-analyzer-core.CallAndMessageModeling
    clang-analyzer-core.DereferenceModeling
    clang-analyzer-core.DivideZero
    clang-analyzer-core.DynamicTypePropagation
    clang-analyzer-core.NonNullParamChecker
    clang-analyzer-core.NonnilStringConstants
    clang-analyzer-core.NullDereference
    clang-analyzer-core.StackAddrEscapeBase
    clang-analyzer-core.StackAddressEscape
    clang-analyzer-core.UndefinedBinaryOperatorResult
    clang-analyzer-core.VLASize
    clang-analyzer-core.builtin.BuiltinFunctions
    clang-analyzer-core.builtin.NoReturnFunctions
    clang-analyzer-core.uninitialized.ArraySubscript
    clang-analyzer-core.uninitialized.Assign
    clang-analyzer-core.uninitialized.Branch
    clang-analyzer-core.uninitialized.CapturedBlockVariable
    clang-analyzer-core.uninitialized.NewArraySize
    clang-analyzer-core.uninitialized.UndefReturn
    clang-analyzer-cplusplus.ArrayDelete
    clang-analyzer-cplusplus.InnerPointer
    clang-analyzer-cplusplus.Move
    clang-analyzer-cplusplus.NewDelete
    clang-analyzer-cplusplus.NewDeleteLeaks
    clang-analyzer-cplusplus.PlacementNew
    clang-analyzer-cplusplus.PureVirtualCall
    clang-analyzer-cplusplus.SelfAssignment
    clang-analyzer-cplusplus.SmartPtrModeling
    clang-analyzer-cplusplus.StringChecker
    clang-analyzer-cplusplus.VirtualCallModeling
    clang-analyzer-deadcode.DeadStores
    clang-analyzer-fuchsia.HandleChecker
    clang-analyzer-nullability.NullPassedToNonnull
    clang-analyzer-nullability.NullReturnedFromNonnull
    clang-analyzer-nullability.NullabilityBase
    clang-analyzer-nullability.NullableDereferenced
    clang-analyzer-nullability.NullablePassedToNonnull
    clang-analyzer-nullability.NullableReturnedFromNonnull
    clang-analyzer-optin.core.EnumCastOutOfRange
    clang-analyzer-optin.cplusplus.UninitializedObject
    clang-analyzer-optin.cplusplus.VirtualCall
    clang-analyzer-optin.mpi.MPI-Checker
    clang-analyzer-optin.osx.OSObjectCStyleCast
    clang-analyzer-optin.osx.cocoa.localizability.EmptyLocalizationContextChecker
    clang-analyzer-optin.osx.cocoa.localizability.NonLocalizedStringChecker
    clang-analyzer-optin.performance.GCDAntipattern
    clang-analyzer-optin.performance.Padding
    clang-analyzer-optin.portability.UnixAPI
    clang-analyzer-optin.taint.GenericTaint
    clang-analyzer-optin.taint.TaintPropagation
    clang-analyzer-optin.taint.TaintedAlloc
    clang-analyzer-optin.taint.TaintedDiv
    clang-analyzer-osx.API
    clang-analyzer-osx.MIG
    clang-analyzer-osx.NSOrCFErrorDerefChecker
    clang-analyzer-osx.NumberObjectConversion
    clang-analyzer-osx.OSObjectRetainCount
    clang-analyzer-osx.ObjCProperty
    clang-analyzer-osx.SecKeychainAPI
    clang-analyzer-osx.cocoa.AtSync
    clang-analyzer-osx.cocoa.AutoreleaseWrite
    clang-analyzer-osx.cocoa.ClassRelease
    clang-analyzer-osx.cocoa.Dealloc
    clang-analyzer-osx.cocoa.IncompatibleMethodTypes
    clang-analyzer-osx.cocoa.Loops
    clang-analyzer-osx.cocoa.MissingSuperCall
    clang-analyzer-osx.cocoa.NSAutoreleasePool
    clang-analyzer-osx.cocoa.NSError
    clang-analyzer-osx.cocoa.NilArg
    clang-analyzer-osx.cocoa.NonNilReturnValue
    clang-analyzer-osx.cocoa.ObjCGenerics
    clang-analyzer-osx.cocoa.RetainCount
    clang-analyzer-osx.cocoa.RetainCountBase
    clang-analyzer-osx.cocoa.RunLoopAutoreleaseLeak
    clang-analyzer-osx.cocoa.SelfInit
    clang-analyzer-osx.cocoa.SuperDealloc
    clang-analyzer-osx.cocoa.UnusedIvars
    clang-analyzer-osx.cocoa.VariadicMethodTypes
    clang-analyzer-osx.coreFoundation.CFError
    clang-analyzer-osx.coreFoundation.CFNumber
    clang-analyzer-osx.coreFoundation.CFRetainRelease
    clang-analyzer-osx.coreFoundation.containers.OutOfBounds
    clang-analyzer-osx.coreFoundation.containers.PointerSizedValues
    clang-analyzer-security.ArrayBound
    clang-analyzer-security.FloatLoopCounter
    clang-analyzer-security.MmapWriteExec
    clang-analyzer-security.PointerSub
    clang-analyzer-security.PutenvStackArray
    clang-analyzer-security.SetgidSetuidOrder
    clang-analyzer-security.cert.env.InvalidPtr
    clang-analyzer-security.insecureAPI.DeprecatedOrUnsafeBufferHandling
    clang-analyzer-security.insecureAPI.SecuritySyntaxChecker
    clang-analyzer-security.insecureAPI.UncheckedReturn
    clang-analyzer-security.insecureAPI.bcmp
    clang-analyzer-security.insecureAPI.bcopy
    clang-analyzer-security.insecureAPI.bzero
    clang-analyzer-security.insecureAPI.decodeValueOfObjCType
    clang-analyzer-security.insecureAPI.getpw
    clang-analyzer-security.insecureAPI.gets
    clang-analyzer-security.insecureAPI.mkstemp
    clang-analyzer-security.insecureAPI.mktemp
    clang-analyzer-security.insecureAPI.rand
    clang-analyzer-security.insecureAPI.strcpy
    clang-analyzer-security.insecureAPI.vfork
    clang-analyzer-unix.API
    clang-analyzer-unix.BlockInCriticalSection
    clang-analyzer-unix.Chroot
    clang-analyzer-unix.DynamicMemoryModeling
    clang-analyzer-unix.Errno
    clang-analyzer-unix.Malloc
    clang-analyzer-unix.MallocSizeof
    clang-analyzer-unix.MismatchedDeallocator
    clang-analyzer-unix.StdCLibraryFunctions
    clang-analyzer-unix.Stream
    clang-analyzer-unix.Vfork
    clang-analyzer-unix.cstring.BadSizeArg
    clang-analyzer-unix.cstring.CStringModeling
    clang-analyzer-unix.cstring.NotNullTerminated
    clang-analyzer-unix.cstring.NullArg
    clang-analyzer-valist.CopyToSelf
    clang-analyzer-valist.Uninitialized
    clang-analyzer-valist.Unterminated
    clang-analyzer-valist.ValistBase
    clang-analyzer-webkit.NoUncountedMemberChecker
    clang-analyzer-webkit.RefCntblBaseVirtualDtor
    clang-analyzer-webkit.UncountedLambdaCapturesChecker
    readability-braces-around-statements

Running clang-tidy for 32 files out of 32 in compilation database ...
[ 1/32][0.0s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpjozu9jms.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/orderedmap.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1morderedmap.c:15:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   15 |         if(!o) return;[0m
      | [0;1;32m              ^       
[0m      | [0;32m               {
[0m[1morderedmap.c:19:9: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   19 |                         if(p) free(*p);[0m
      | [0;1;32m                             ^         
[0m      | [0;32m                              {
[0m[1morderedmap.c:26:44: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   26 |                 while((i = htab_next(o->map, i, &q, &v)))[0m
      | [0;1;32m                                                         ^
[0m      | [0;32m                                                          {
[0m   27 |                         free(q);[0m
      | [0;1;32m                                
[0m[1morderedmap.c:35:15: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   35 |         if(!o.values) goto oom;[0m
      | [0;1;32m                     ^         
[0m      | [0;32m                      {
[0m[1morderedmap.c:37:12: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   37 |         if(!o.map) goto oom;[0m
      | [0;1;32m                  ^         
[0m      | [0;32m                   {
[0m[1morderedmap.c:39:10: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   39 |         if(!new) goto oom;[0m
      | [0;1;32m                ^         
[0m      | [0;32m                 {
[0m[1morderedmap.c:59:16: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   59 |         if(!nk || !nv) goto oom;[0m
      | [0;1;32m                      ^         
[0m      | [0;32m                       {
[0m[1morderedmap.c:61:33: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   61 |         if(!sblist_add(o->values, &nv)) goto oom;[0m
      | [0;1;32m                                       ^         
[0m      | [0;32m                                        {
[0m[1morderedmap.c:76:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   76 |         if(!v) return 0;[0m
      | [0;1;32m              ^         
[0m      | [0;32m               {
[0m[1morderedmap.c:87:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   87 |         if(!v) return 0;[0m
      | [0;1;32m              ^         
[0m      | [0;32m               {
[0m[1morderedmap.c:93:19: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   93 |                 if(lv->n > v->n) lv->n--;[0m
      | [0;1;32m                                ^        
[0m      | [0;32m                                 {
[0m19 warnings generated.
Suppressed 6 warnings (6 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 2/32][0.0s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp7yye6iar.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/sblist.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1msblist.c:31:15: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   31 |                 if(l->items) free(l->items);[0m
      | [0;1;32m                            ^               
[0m      | [0;32m                             {
[0m[1msblist.c:48:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   48 |         if(item < l->count) return (void*) sblist_item_from_index(l, item);[0m
      | [0;1;32m                           ^                                               
[0m      | [0;32m                            {
[0m[1msblist.c:53:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   53 |         if(pos >= l->count) return 0;[0m
      | [0;1;32m                           ^         
[0m      | [0;32m                            {
[0m[1msblist.c:62:12: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   62 |                 if(!temp) return 0;[0m
      | [0;1;32m                         ^         
[0m      | [0;32m                          {
[0m[1msblist.c:70:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   70 |         if(!sblist_grow_if_needed(l)) return 0;[0m
      | [0;1;32m                                     ^         
[0m      | [0;32m                                      {
[0m14 warnings generated.
Suppressed 7 warnings (7 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 3/32][0.0s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpfd5o05ib.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/conf-tokens.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
10 warnings generated.
Suppressed 8 warnings (8 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 4/32][0.3s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpgcqsfuuo.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/base64.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
4 warnings generated.
Suppressed 2 warnings (2 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 5/32][0.4s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpvl9fiyez.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/text.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mtext.c:40:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   40 |         if (len >= size)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m   41 |                 len = size - 1;[0m
      | [0;1;32m                               
[0m[1mtext.c:63:33: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   63 |         if (len1 + len2 >= size)[0m
      | [0;1;32m                                ^
[0m      | [0;32m                                 {
[0m   64 |                 len2 = size - len1 - 1;[0m
      | [0;1;32m                                       
[0m[1mtext.c:91:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   91 |         if (buffer == NULL)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m   92 |                 return -EFAULT;[0m
      | [0;1;32m                               
[0m[1mtext.c:93:24: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   93 |         if (length < 1)[0m
      | [0;1;32m                       ^
[0m      | [0;32m                        {
[0m   94 |                 return -ERANGE;[0m
      | [0;1;32m                               
[0m[1mtext.c:104:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  104 |                 if (length-- == 0)[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m  105 |                         break;[0m
      | [0;1;32m                              
[0m39 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 6/32][1.1s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmplntjv1cv.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/heap.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
34 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 7/32][1.4s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpcsukr_oq.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/mypoll.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mmypoll.c:6:23: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
    6 |         for(i=0; i<nfds; ++i) if(!fds[i].events) fds[i].fd=~fds[i].fd;[0m
      | [0;1;32m                             ^                                        
[0m      | [0;32m                              {
[0m[1mmypoll.c:6:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
    6 |         for(i=0; i<nfds; ++i) if(!fds[i].events) fds[i].fd=~fds[i].fd;[0m
      | [0;1;32m                                                ^                     
[0m      | [0;32m                                                 {
[0m[1mmypoll.c:8:23: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
    8 |         for(i=0; i<nfds; ++i) if(!fds[i].events) fds[i].fd=~fds[i].fd;[0m
      | [0;1;32m                             ^                                        
[0m      | [0;32m                              {
[0m[1mmypoll.c:8:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
    8 |         for(i=0; i<nfds; ++i) if(!fds[i].events) fds[i].fd=~fds[i].fd;[0m
      | [0;1;32m                                                ^                     
[0m      | [0;32m                                                 {
[0m8 warnings generated.
Suppressed 2 warnings (2 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 8/32][1.9s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmplnlbliz9.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/http-message.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mhttp-message.c:65:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   65 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m   66 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mhttp-message.c:67:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   67 |         if (msg->headers.strings == NULL)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m   68 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mhttp-message.c:69:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   69 |         if (msg->response.string == NULL)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m   70 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mhttp-message.c:71:64: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   71 |         if (msg->response.code < 1 || msg->response.code > 999)[0m
      | [0;1;32m                                                               ^
[0m      | [0;32m                                                                {
[0m   72 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mhttp-message.c:94:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   94 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m   95 |                 return NULL;[0m
      | [0;1;32m                            
[0m[1mhttp-message.c:128:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  128 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  129 |                 return -EFAULT;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:131:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  131 |         if (msg->headers.strings != NULL)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m  132 |                 safefree (msg->headers.strings);[0m
      | [0;1;32m                                                
[0m[1mhttp-message.c:146:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  146 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  147 |                 return -EFAULT;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:148:54: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  148 |         if (response_code < 1 || response_code > 999)[0m
      | [0;1;32m                                                     ^
[0m      | [0;32m                                                      {
[0m  149 |                 return -EINVAL;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:150:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  150 |         if (response_string == NULL)[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m  151 |                 return -EINVAL;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:152:43: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  152 |         if (strlen (response_string) == 0)[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m  153 |                 return -EINVAL;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:167:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  167 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  168 |                 return -EFAULT;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:169:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  169 |         if (body == NULL)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m  170 |                 return -EINVAL;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:171:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  171 |         if (len == 0)[0m
      | [0;1;32m                     ^
[0m      | [0;32m                      {
[0m  172 |                 return -EINVAL;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:191:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  191 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  192 |                 return -EFAULT;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:193:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  193 |         if (headers == NULL)[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m  194 |                 return -EINVAL;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:204:41: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  204 |                 if (new_headers == NULL)[0m
      | [0;1;32m                                        ^
[0m      | [0;32m                                         {
[0m  205 |                         return -ENOMEM;[0m
      | [0;1;32m                                       
[0m[1mhttp-message.c:208:57: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  208 |                 for (i = 0; i != msg->headers.used; ++i)[0m
      | [0;1;32m                                                        ^
[0m      | [0;32m                                                         {
[0m  209 |                         new_headers[i] = msg->headers.strings[i];[0m
      | [0;1;32m                                                                 
[0m[1mhttp-message.c:220:43: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  220 |         for (i = 0; i != num_headers; ++i)[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m  221 |                 msg->headers.strings[i + msg->headers.used] = headers[i];[0m
      | [0;1;32m                                                                         
[0m[1mhttp-message.c:240:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  240 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  241 |                 return -EFAULT;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:242:20: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  242 |         if (fd < 1)[0m
      | [0;1;32m                   ^
[0m      | [0;32m                    {
[0m  243 |                 return -EBADF;[0m
      | [0;1;32m                              
[0m[1mhttp-message.c:244:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  244 |         if (!is_http_message_valid (msg))[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m  245 |                 return -EINVAL;[0m
      | [0;1;32m                               
[0m[1mhttp-message.c:252:49: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  252 |         for (i = 0; i != msg->headers.used; ++i)[0m
      | [0;1;32m                                                ^
[0m      | [0;32m                                                 {
[0m  253 |                 write_message (fd, "%s\r\n", msg->headers.strings[i]);[0m
      | [0;1;32m                                                                      
[0m[1mhttp-message.c:268:34: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  268 |         if (msg->body.length > 0)[0m
      | [0;1;32m                                 ^
[0m      | [0;32m                                  {
[0m  269 |                 safe_write (fd, msg->body.text, msg->body.length);[0m
      | [0;1;32m                                                                  
[0m58 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[ 9/32][2.0s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmppgt54eid.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/buffer.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mbuffer.c:67:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   67 |         if (!newline)[0m
      | [0;1;32m                     ^
[0m      | [0;32m                      {
[0m   68 |                 return NULL;[0m
      | [0;1;32m                            
[0m[1mbuffer.c:94:19: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   94 |         if (!line)[0m
      | [0;1;32m                  ^
[0m      | [0;32m                   {
[0m   95 |                 return;[0m
      | [0;1;32m                       
[0m[1mbuffer.c:97:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   97 |         if (line->string)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m   98 |                 safefree (line->string);[0m
      | [0;1;32m                                        
[0m[1mbuffer.c:111:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  111 |         if (!buffptr)[0m
      | [0;1;32m                     ^
[0m      | [0;32m                      {
[0m  112 |                 return NULL;[0m
      | [0;1;32m                            
[0m[1mbuffer.c:166:43: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  166 |         if (BUFFER_HEAD (buffptr) == NULL)[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m  167 |                 assert (buffptr->size == 0);[0m
  168 |         else[0m
      | [0;32m        } 
[0m[1mbuffer.c:168:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  168 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m  169 |                 assert (buffptr->size > 0);[0m
      | [0;1;32m                                           
[0m[1mbuffer.c:174:53: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  174 |         if (!(newline = makenewline (data, length)))[0m
      | [0;1;32m                                                    ^
[0m      | [0;32m                                                     {
[0m  175 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mbuffer.c:177:32: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  177 |         if (buffptr->size == 0)[0m
      | [0;1;32m                               ^
[0m      | [0;32m                                {
[0m  178 |                 BUFFER_HEAD (buffptr) = BUFFER_TAIL (buffptr) = newline;[0m
  179 |         else {[0m
      | [0;32m        } 
[0m[1mbuffer.c:223:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  223 |         if (buffptr->size >= MAXBUFFSIZE)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m  224 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mbuffer.c:253:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  253 |                         break;[0m
      | [0;1;32m                        ^    
[0m      | [0;32m                        {    ;} 
[0m[1mbuffer.c:255:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  255 |                         log_message (LOG_ERR,[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  256 |                                      "read_buffer: read() failed on fd %d: %s",[0m
  257 |                                      fd, strerror(errno));[0m
  258 |                         bytesin = -1;[0m
  259 |                         break;[0m
      | [0;1;32m                             
[0m      | [0;32m                             ;} 
[0m[1mbuffer.c:279:32: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  279 |         if (buffptr->size == 0)[0m
      | [0;1;32m                               ^
[0m      | [0;32m                                {
[0m  280 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mbuffer.c:293:47: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  293 |                 if (line->pos == line->length)[0m
      | [0;1;32m                                              ^
[0m      | [0;32m                                               {
[0m  294 |                         free_line (remove_from_buffer (buffptr));[0m
      | [0;1;32m                                                                 
[0m[1mbuffer.c:313:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  313 |                         return 0;[0m
      | [0;1;32m                        ^       
[0m      | [0;32m                        {       ;} 
[0m[1mbuffer.c:315:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  315 |                         log_message (LOG_ERR,[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  316 |                                      "writebuff: write() error \"%s\" on file descriptor %d",[0m
  317 |                                      strerror (errno), fd);[0m
  318 |                         return -1;[0m
      | [0;1;32m                                 
[0m      | [0;32m                                 ;} 
[0m49 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[10/32][2.1s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpwjy9nrod.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/anonymous.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1manonymous.c:60:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   60 |                 if (!conf->anonymous_map)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m   61 |                         return -1;[0m
      | [0;1;32m                                  
[0m35 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[11/32][2.1s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpy5qbb38r.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/basicauth.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mbasicauth.c:40:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   40 |         if (!user || !pass) return -1;[0m
      | [0;1;32m                           ^          
[0m      | [0;32m                            {
[0m[1mbasicauth.c:42:41: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   42 |         if (l < 0 || l >= (ssize_t) sizeof tmp) return 0;[0m
      | [0;1;32m                                               ^         
[0m      | [0;32m                                                {
[0m[1mbasicauth.c:43:51: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   43 |         if (bufsize < (BASE64ENC_BYTES((unsigned)l) + 1)) return 0;[0m
      | [0;1;32m                                                         ^         
[0m      | [0;32m                                                          {
[0m[1mbasicauth.c:89:23: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   89 |         if (!authlist) return 0;[0m
      | [0;1;32m                      ^         
[0m      | [0;32m                       {
[0m[1mbasicauth.c:93:63: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   93 |                 if (entry && strcmp (authstring, *entry) == 0)[0m
      | [0;1;32m                                                              ^
[0m      | [0;32m                                                               {
[0m   94 |                         return 1;[0m
      | [0;1;32m                                 
[0m39 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[12/32][3.0s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp4ny38dzh.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/utils.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mutils.c:50:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   50 |         if (msg == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m   51 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mutils.c:102:36: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  102 |                 if (!truncate_file)[0m
      | [0;1;32m                                   ^
[0m      | [0;32m                                    {
[0m  103 |                         flags |= O_APPEND;[0m
      | [0;1;32m                                          
[0m[1mutils.c:150:36: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  150 |                 if (!truncate_file)[0m
      | [0;1;32m                                   ^
[0m      | [0;32m                                    {
[0m  151 |                         return fildes;[0m
      | [0;1;32m                                      
[0m[1mutils.c:197:64: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  197 |         if ((fildes = create_file_safely (filename, TRUE)) < 0)[0m
      | [0;1;32m                                                               ^
[0m      | [0;32m                                                                {
[0m  198 |                 return fildes;[0m
      | [0;1;32m                              
[0m38 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[13/32][3.1s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp3kqcva1v.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/connect-ports.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mconnect-ports.c:59:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   59 |         if (!connect_ports)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m   60 |                 return 1;[0m
      | [0;1;32m                         
[0m[1mconnect-ports.c:64:43: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   64 |                 if (data && *data == port)[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m   65 |                         return 1;[0m
      | [0;1;32m                                 
[0m36 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[14/32][3.4s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmprs0fbr7k.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/stats.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mstats.c:144:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  144 |                 ++stats->num_badcons;[0m
      | [0;1;32m                ^
[0m      | [0;32m                {
[0m  145 |                 break;[0m
      | [0;1;32m                     
[0m      | [0;32m                     ;} 
[0m[1mstats.c:147:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  147 |                 ++stats->num_open;[0m
      | [0;1;32m                ^
[0m      | [0;32m                {
[0m  148 |                 ++stats->num_reqs;[0m
  149 |                 break;[0m
      | [0;1;32m                     
[0m      | [0;32m                     ;} 
[0m[1mstats.c:151:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  151 |                 --stats->num_open;[0m
      | [0;1;32m                ^
[0m      | [0;32m                {
[0m  152 |                 break;[0m
      | [0;1;32m                     
[0m      | [0;32m                     ;} 
[0m[1mstats.c:154:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  154 |                 ++stats->num_refused;[0m
      | [0;1;32m                ^
[0m      | [0;32m                {
[0m  155 |                 break;[0m
      | [0;1;32m                     
[0m      | [0;32m                     ;} 
[0m[1mstats.c:157:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  157 |                 ++stats->num_denied;[0m
      | [0;1;32m                ^
[0m      | [0;32m                {
[0m  158 |                 break;[0m
      | [0;1;32m                     
[0m      | [0;32m                     ;} 
[0m[1mstats.c:160:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  160 |                 ret = -1;[0m
      | [0;1;32m                ^       
[0m      | [0;32m                {       ;} 
[0m40 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[15/32][3.5s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpi78bqsyc.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/daemon.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mdaemon.c:35:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   35 |         if (fork () != 0)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m   36 |                 exit (0);[0m
      | [0;1;32m                         
[0m[1mdaemon.c:41:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   41 |         if (fork () != 0)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m   42 |                 exit (0);[0m
      | [0;1;32m                         
[0m[1mdaemon.c:83:48: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   83 |         if (sigaction (signo, &act, &oact) < 0)[0m
      | [0;1;32m                                               ^
[0m      | [0;32m                                                {
[0m   84 |                 return SIG_ERR;[0m
      | [0;1;32m                               
[0m37 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[16/32][3.8s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmppxpfc7yc.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/hostspec.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mhostspec.c:9:55: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
    9 |         if (1 != inet_pton (AF_INET, bitmask_string, v4bits)) return -1;[0m
      | [0;1;32m                                                             ^          
[0m      | [0;32m                                                              {
[0m[1mhostspec.c:33:10: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   33 |                 if (v6) return -1; /* ipv6 doesn't supported dotted netmasks */[0m
      | [0;1;32m                       ^                                                       
[0m      | [0;32m                        {
[0m[1mhostspec.c:40:65: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   40 |             || (errno != 0 && mask == 0) || (endptr == bitmask_string))[0m
      | [0;1;32m                                                                       ^
[0m      | [0;32m                                                                        {
[0m   41 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mhostspec.c:51:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   51 |         if (mask > (8 * IPV6_LEN))[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m   52 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mhostspec.c:80:15: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   80 |         if(!location) return 0;[0m
      | [0;1;32m                     ^         
[0m      | [0;32m                      {
[0m[1mhostspec.c:83:38: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   83 |         if ((mask = strrchr(location, '/')))[0m
      | [0;1;32m                                            ^
[0m      | [0;32m                                             {
[0m   84 |                 *(mask++) = 0;[0m
      | [0;1;32m                              
[0m[1mhostspec.c:92:12: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   92 |                 if(!mask) memset (h->address.ip.mask, 0xff, IPV6_LEN);[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m   93 |                 else {[0m
      | [0;32m                } 
[0m[1mhostspec.c:98:47: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   98 |                         if (inet_pton(AF_INET6, location, dst) > 0)[0m
      | [0;1;32m                                                                   ^
[0m      | [0;32m                                                                    {
[0m   99 |                                 v6 = 1;[0m
  100 |                         else[0m
      | [0;32m                        } 
[0m[1mhostspec.c:100:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  100 |                         else[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m  101 |                                 v6 = 0;[0m
      | [0;1;32m                                       
[0m[1mhostspec.c:105:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  105 |                              < 0)[0m
      | [0;1;32m                                 ^
[0m      | [0;32m                                  {
[0m  106 |                                 goto err;[0m
      | [0;1;32m                                         
[0m[1mhostspec.c:108:34: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  108 |                         for (i = 0; i < IPV6_LEN; i++)[0m
      | [0;1;32m                                                      ^
[0m      | [0;32m                                                       {
[0m  109 |                                 h->address.ip.network[i] = ip_dst[i] &[0m
  110 |                                 h->address.ip.mask[i];[0m
      | [0;1;32m                                                      
[0m[1mhostspec.c:115:38: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  115 |                 if (mask || strchr (location, ':'))[0m
      | [0;1;32m                                                   ^
[0m      | [0;32m                                                    {
[0m  116 |                         goto err;[0m
      | [0;1;32m                                 
[0m[1mhostspec.c:121:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  121 |                 if (!h->address.string)[0m
      | [0;1;32m                                       ^
[0m      | [0;32m                                        {
[0m  122 |                         goto err;[0m
      | [0;1;32m                                 
[0m[1mhostspec.c:125:10: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  125 |         if(mask) *(--mask) = '/';[0m
      | [0;1;32m                ^                
[0m      | [0;32m                 {
[0m[1mhostspec.c:128:10: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  128 |         if(mask) *(--mask) = '/';[0m
      | [0;1;32m                ^                
[0m      | [0;32m                 {
[0m[1mhostspec.c:135:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  135 |         if(!strcasecmp(ip, addrspec)) return 1;[0m
      | [0;1;32m                                     ^         
[0m      | [0;32m                                      {
[0m[1mhostspec.c:136:24: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  136 |         if(addrspec[0] != '.') return 0;[0m
      | [0;1;32m                              ^         
[0m      | [0;32m                               {
[0m[1mhostspec.c:139:33: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  139 |         if (test_length < match_length) return 0;[0m
      | [0;1;32m                                       ^         
[0m      | [0;32m                                        {
[0m[1mhostspec.c:155:14: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  155 |                 if (x != y)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m  156 |                         return 0;[0m
      | [0;1;32m                                 
[0m[1mhostspec.c:167:20: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  167 |         if (ip[0] == '\0') return 0;[0m
      | [0;1;32m                          ^         
[0m      | [0;32m                           {
[0m[1mhostspec.c:171:3: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  171 |                 if(is_numeric_addr) return 0;[0m
      | [0;1;32m                ^
[0m      | [0;32m                {
[0m  172 |                 return string_match (ip, h->address.string);[0m
      | [0;1;32m                                                           
[0m      | [0;32m                                                           ;} 
[0m[1mhostspec.c:171:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  171 |                 if(is_numeric_addr) return 0;[0m
      | [0;1;32m                                   ^         
[0m      | [0;32m                                    {
[0m[1mhostspec.c:174:3: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  174 |                 return numeric_match (numeric_addr, h);[0m
      | [0;1;32m                ^                                     
[0m      | [0;32m                {                                     ;} 
[0m[1mhostspec.c:176:3: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  176 |                 return 0;[0m
      | [0;1;32m                ^       
[0m      | [0;32m                {       ;} 
[0m58 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[17/32][3.9s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmppxju28rd.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/loop.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mloop.c:67:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   67 |                         if (af != our_af) goto next;[0m
      | [0;1;32m                                         ^          
[0m      | [0;32m                                          {
[0m[1mloop.c:69:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   69 |                         if (port != our_port) goto next;[0m
      | [0;1;32m                                             ^          
[0m      | [0;32m                                              {
[0m29 warnings generated.
Suppressed 25 warnings (25 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[18/32][4.8s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpgs3sgrcp.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/transparent-proxy.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mtransparent-proxy.c:49:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   49 |         if (*url == NULL)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m   50 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mtransparent-proxy.c:86:20: [0m[0;1;35mwarning: [0m[1mAssigned value is garbage or undefined [clang-analyzer-core.uninitialized.Assign][0m
   86 |                 af = SOCKADDR_UNION_AF(&dest_addr);[0m
      | [0;1;32m                   ^
[0m[1mtransparent-proxy.c:66:13: [0m[0;1;36mnote: [0mAssuming 'data' is null[0m
   66 |         if (!data) {[0m
      | [0;1;32m            ^~~~~
[0m[1mtransparent-proxy.c:66:9: [0m[0;1;36mnote: [0mTaking true branch[0m
   66 |         if (!data) {[0m
      | [0;1;32m        ^
[0m[1mtransparent-proxy.c:73:21: [0m[0;1;36mnote: [0mLeft side of '||' is false[0m
   73 |                 if (getsockname[0m
      | [0;1;32m                    ^
[0m[1mtransparent-proxy.c:75:38: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
   75 |                      &length) < 0 || length > sizeof(dest_addr)) {[0m
      | [0;1;32m                                     ^~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mtransparent-proxy.c:73:17: [0m[0;1;36mnote: [0mTaking false branch[0m
   73 |                 if (getsockname[0m
      | [0;1;32m                ^
[0m[1mtransparent-proxy.c:86:20: [0m[0;1;36mnote: [0mAssigned value is garbage or undefined[0m
   86 |                 af = SOCKADDR_UNION_AF(&dest_addr);[0m
      | [0;1;32m                   ^
[0m[1mtransparent-proxy.c:89:74: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   89 |                 if (!inet_ntop(af, dest_inaddr, namebuf, sizeof namebuf))[0m
      | [0;1;32m                                                                         ^
[0m      | [0;32m                                                                          {
[0m   90 |                         goto addr_err;[0m
      | [0;1;32m                                      
[0m37 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[19/32][6.4s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp5r64iygb.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/upstream.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mupstream.c:38:23: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   38 |         case PT_NONE: return "none";[0m
      | [0;1;32m                      ^            
[0m      | [0;32m                      {            ;} 
[0m[1mupstream.c:39:23: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   39 |         case PT_HTTP: return "http";[0m
      | [0;1;32m                      ^            
[0m      | [0;32m                      {            ;} 
[0m[1mupstream.c:40:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   40 |         case PT_SOCKS4: return "socks4";[0m
      | [0;1;32m                        ^              
[0m      | [0;32m                        {              ;} 
[0m[1mupstream.c:41:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   41 |         case PT_SOCKS5: return "socks5";[0m
      | [0;1;32m                        ^              
[0m      | [0;32m                        {              ;} 
[0m[1mupstream.c:42:18: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   42 |         default: return "unknown";[0m
      | [0;1;32m                 ^               
[0m      | [0;32m                 {               ;} 
[0m[1mupstream.c:85:40: [0m[0;1;35mwarning: [0m[1mPotential leak of memory pointed to by 'up' [clang-analyzer-unix.Malloc][0m
   85 |                                 *ube = UBE_USERLEN;[0m
      | [0;1;32m                                       ^
[0m[1mupstream.c:160:14: [0m[0;1;36mnote: [0mCalling 'upstream_build'[0m
  160 |         up = upstream_build (host, port, domain, user, pass, type, &ube);[0m
      | [0;1;32m             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mupstream.c:70:34: [0m[0;1;36mnote: [0mMemory is allocated[0m
   70 |         up = (struct upstream *) safemalloc (sizeof (struct upstream));[0m
      | [0;1;32m                                 ^
[0m[1m./heap.h:48:25: [0m[0;1;36mnote: [0mexpanded from macro 'safemalloc'[0m
   48 | #  define safemalloc(x) malloc(x)[0m
      | [0;1;32m                        ^~~~~~~~~
[0m[1mupstream.c:71:13: [0m[0;1;36mnote: [0mAssuming 'up' is non-null[0m
   71 |         if (!up) {[0m
      | [0;1;32m            ^~~
[0m[1mupstream.c:71:9: [0m[0;1;36mnote: [0mTaking false branch[0m
   71 |         if (!up) {[0m
      | [0;1;32m        ^
[0m[1mupstream.c:79:13: [0m[0;1;36mnote: [0mAssuming 'user' is non-null[0m
   79 |         if (user) {[0m
      | [0;1;32m            ^~~~
[0m[1mupstream.c:79:9: [0m[0;1;36mnote: [0mTaking true branch[0m
   79 |         if (user) {[0m
      | [0;1;32m        ^
[0m[1mupstream.c:80:21: [0m[0;1;36mnote: [0mAssuming 'type' is equal to PT_HTTP[0m
   80 |                 if (type == PT_HTTP) {[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~
[0m[1mupstream.c:80:17: [0m[0;1;36mnote: [0mTaking true branch[0m
   80 |                 if (type == PT_HTTP) {[0m
      | [0;1;32m                ^
[0m[1mupstream.c:84:29: [0m[0;1;36mnote: [0mAssuming 'ret' is equal to 0[0m
   84 |                         if (ret == 0) {[0m
      | [0;1;32m                            ^~~~~~~~
[0m[1mupstream.c:84:25: [0m[0;1;36mnote: [0mTaking true branch[0m
   84 |                         if (ret == 0) {[0m
      | [0;1;32m                        ^
[0m[1mupstream.c:85:40: [0m[0;1;36mnote: [0mPotential leak of memory pointed to by 'up'[0m
   85 |                                 *ube = UBE_USERLEN;[0m
      | [0;1;32m                                       ^
[0m[1mupstream.c:113:40: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  113 |                         if (!domain[0]) goto e_nonedomain;[0m
      | [0;1;32m                                       ^                  
[0m      | [0;32m                                        {
[0m[1mupstream.c:129:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  129 |                 if (type == PT_NONE)[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m  130 |                         log_message (LOG_INFO, "Added upstream none for %s", domain);[0m
  131 |                 else[0m
      | [0;32m                } 
[0m[1mupstream.c:131:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  131 |                 else[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m  132 |                         log_message (LOG_INFO, "Added upstream %s %s:%d for %s",[0m
  133 |                                      proxy_type_name(type), host, port, domain);[0m
      | [0;1;32m                                                                                
[0m[1mupstream.c:142:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  142 |         if(up->target.type == HST_STRING)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m  143 |                 safefree (up->target.address.string);[0m
      | [0;1;32m                                                     
[0m[1mupstream.c:192:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  192 |         if(up->target.type == HST_STRING)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m  193 |                 safefree (up->target.address.string);[0m
      | [0;1;32m                                                     
[0m[1mupstream.c:205:49: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  205 |                 if (up->target.type == HST_NONE)[0m
      | [0;1;32m                                                ^
[0m      | [0;32m                                                 {
[0m  206 |                         break;[0m
      | [0;1;32m                              
[0m[1mupstream.c:208:55: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  208 |                 if (hostspec_match(host, &up->target))[0m
      | [0;1;32m                                                      ^
[0m      | [0;32m                                                       {
[0m  209 |                         break;[0m
      | [0;1;32m                              
[0m[1mupstream.c:214:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  214 |         if (up && (!up->host))[0m
      | [0;1;32m                              ^
[0m      | [0;32m                               {
[0m  215 |                 up = NULL;[0m
      | [0;1;32m                          
[0m[1mupstream.c:217:16: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  217 |         if (up)[0m
      | [0;1;32m               ^
[0m      | [0;32m                {
[0m  218 |                 log_message (LOG_INFO, "Found upstream proxy %s %s:%d for %s",[0m
  219 |                              proxy_type_name(up->type), up->host, up->port, host);[0m
  220 |         else[0m
      | [0;32m        } 
[0m[1mupstream.c:220:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  220 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m  221 |                 log_message (LOG_INFO, "No upstream proxy for %s", host);[0m
      | [0;1;32m                                                                         
[0m[1mupstream.c:231:51: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  231 |                 if(tmp->target.type == HST_STRING)[0m
      | [0;1;32m                                                  ^
[0m      | [0;32m                                                   {
[0m  232 |                         safefree (tmp->target.address.string);[0m
      | [0;1;32m                                                              
[0m51 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[20/32][8.8s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp78f0rxek.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/filter.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mfilter.c:79:30: [0m[0;1;35mwarning: [0m[1mPotential out of bound access to the region with tainted index [clang-analyzer-security.ArrayBound][0m
   79 |                 while (*s && isspace ((unsigned char) *s))[0m
      | [0;1;32m                             ^
[0m[1m/usr/include/ctype.h:197:21: [0m[0;1;36mnote: [0mexpanded from macro 'isspace'[0m
  197 | # define isspace(c)     __isctype((c), _ISspace)[0m
      | [0;1;32m                        ^
[0m[1m/usr/include/ctype.h:89:4: [0m[0;1;36mnote: [0mexpanded from macro '__isctype'[0m
   89 |   ((*__ctype_b_loc ())[(int) (c)] & (unsigned short int) type)[0m
      | [0;1;32m   ^
[0m[1mfilter.c:169:13: [0m[0;1;36mnote: [0mAssuming field 'filter' is non-null[0m
  169 |         if (config->filter) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~
[0m[1mfilter.c:169:9: [0m[0;1;36mnote: [0mTaking true branch[0m
  169 |         if (config->filter) {[0m
      | [0;1;32m        ^
[0m[1mfilter.c:172:17: [0m[0;1;36mnote: [0mCalling 'filter_init'[0m
  172 |                 filter_init ();[0m
      | [0;1;32m                ^~~~~~~~~~~~~~
[0m[1mfilter.c:61:13: [0m[0;1;36mnote: [0mAssuming 'fl' is null[0m
   61 |         if (fl || already_init) {[0m
      | [0;1;32m            ^~
[0m[1mfilter.c:61:13: [0m[0;1;36mnote: [0mLeft side of '||' is false[0m
[1mfilter.c:61:19: [0m[0;1;36mnote: [0m'already_init' is 0[0m
   61 |         if (fl || already_init) {[0m
      | [0;1;32m                  ^~~~~~~~~~~~
[0m[1mfilter.c:61:9: [0m[0;1;36mnote: [0mTaking false branch[0m
   61 |         if (fl || already_init) {[0m
      | [0;1;32m        ^
[0m[1mfilter.c:65:14: [0m[0;1;36mnote: [0mTaint originated here[0m
   65 |         fd = fopen (config->filter, "r");[0m
      | [0;1;32m             ^~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mfilter.c:65:14: [0m[0;1;36mnote: [0mTaint propagated to the return value[0m
   65 |         fd = fopen (config->filter, "r");[0m
      | [0;1;32m             ^~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mfilter.c:65:14: [0m[0;1;36mnote: [0mAssuming that 'fopen' is successful[0m
   65 |         fd = fopen (config->filter, "r");[0m
      | [0;1;32m             ^~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mfilter.c:66:14: [0m[0;1;36mnote: [0m'fd' is non-null[0m
   66 |         if (!fd) {[0m
      | [0;1;32m             ^~
[0m[1mfilter.c:66:9: [0m[0;1;36mnote: [0mTaking false branch[0m
   66 |         if (!fd) {[0m
      | [0;1;32m        ^
[0m[1mfilter.c:72:36: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
   72 |         cflags |= (REG_EXTENDED * !!(config->filter_opts & FILTER_OPT_TYPE_ERE));[0m
      | [0;1;32m                                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mfilter.c:73:32: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
   73 |         cflags |= (REG_ICASE * !(config->filter_opts & FILTER_OPT_CASESENSITIVE));[0m
      | [0;1;32m                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mfilter.c:75:16: [0m[0;1;36mnote: [0mTaint propagated to the 1st argument[0m
   75 |         while (fgets (buf, FILTER_BUFFER_LEN, fd)) {[0m
      | [0;1;32m               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mfilter.c:75:9: [0m[0;1;36mnote: [0mLoop condition is true.  Entering loop body[0m
   75 |         while (fgets (buf, FILTER_BUFFER_LEN, fd)) {[0m
      | [0;1;32m        ^
[0m[1mfilter.c:79:24: [0m[0;1;36mnote: [0mAssuming the condition is true[0m
   79 |                 while (*s && isspace ((unsigned char) *s))[0m
      | [0;1;32m                       ^~
[0m[1mfilter.c:79:24: [0m[0;1;36mnote: [0mLeft side of '&&' is true[0m
[1mfilter.c:79:30: [0m[0;1;36mnote: [0mAccess of the region with a tainted index that may be too large[0m
   79 |                 while (*s && isspace ((unsigned char) *s))[0m
      | [0;1;32m                             ^
[0m[1m/usr/include/ctype.h:197:21: [0m[0;1;36mnote: [0mexpanded from macro 'isspace'[0m
  197 | # define isspace(c)     __isctype((c), _ISspace)[0m
      | [0;1;32m                        ^~~~~~~~~~~~~~~~~~~~~~~~
[0m[1m/usr/include/ctype.h:89:4: [0m[0;1;36mnote: [0mexpanded from macro '__isctype'[0m
   89 |   ((*__ctype_b_loc ())[(int) (c)] & (unsigned short int) type)[0m
      | [0;1;32m   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mfilter.c:79:59: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   79 |                 while (*s && isspace ((unsigned char) *s))[0m
      | [0;1;32m                                                          ^
[0m      | [0;32m                                                           {
[0m   80 |                         s++;[0m
      | [0;1;32m                            
[0m[1mfilter.c:88:58: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   88 |                         if (isspace ((unsigned char) *s))[0m
      | [0;1;32m                                                         ^
[0m      | [0;32m                                                          {
[0m   89 |                                 break;[0m
      | [0;1;32m                                      
[0m[1mfilter.c:96:66: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   96 |                                 if (s == buf || *(s - 1) != '\\')[0m
      | [0;1;32m                                                                 ^
[0m      | [0;32m                                                                  {
[0m   97 |                                         break;[0m
      | [0;1;32m                                              
[0m[1mfilter.c:105:32: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  105 |                 if (*s == '\0')[0m
      | [0;1;32m                               ^
[0m      | [0;32m                                {
[0m  106 |                         continue;[0m
      | [0;1;32m                                 
[0m[1mfilter.c:108:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  108 |                 if (!fl) fl = sblist_new(sizeof(struct filter_list),[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  109 |                                          4096/sizeof(struct filter_list));[0m
      | [0;1;32m                                                                          
[0m[1mfilter.c:113:43: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  113 |                         if (!fe.u.pattern) goto oom;[0m
      | [0;1;32m                                          ^         
[0m      | [0;32m                                           {
[0m[1mfilter.c:118:55: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  118 |                                 if (err == REG_ESPACE) goto oom;[0m
      | [0;1;32m                                                      ^         
[0m      | [0;32m                                                       {
[0m[1mfilter.c:152:83: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  152 |                                 if (config->filter_opts & FILTER_OPT_TYPE_FNMATCH)[0m
      | [0;1;32m                                                                                  ^
[0m      | [0;32m                                                                                   {
[0m  153 |                                         safefree(p->u.pattern);[0m
  154 |                                 else[0m
      | [0;32m                                } 
[0m[1mfilter.c:154:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  154 |                                 else[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m  155 |                                         regfree (&p->u.cpatb);[0m
      | [0;1;32m                                                              
[0m[1mfilter.c:183:34: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  183 |         if (!fl || !already_init)[0m
      | [0;1;32m                                 ^
[0m      | [0;32m                                  {
[0m  184 |                 goto COMMON_EXIT;[0m
      | [0;1;32m                                 
[0m[1mfilter.c:188:67: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  188 |                 if (config->filter_opts & FILTER_OPT_TYPE_FNMATCH)[0m
      | [0;1;32m                                                                  ^
[0m      | [0;32m                                                                   {
[0m  189 |                         result = fnmatch (p->u.pattern, str, 0);[0m
  190 |                 else[0m
      | [0;32m                } 
[0m[1mfilter.c:190:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  190 |                 else[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m  191 |                         result =[0m
  192 |                             regexec (&p->u.cpatb, str, (size_t) 0, (regmatch_t *) 0, 0);[0m
      | [0;1;32m                                                                                        
[0m[1mfilter.c:195:78: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  195 |                         if (!(config->filter_opts & FILTER_OPT_DEFAULT_DENY))[0m
      | [0;1;32m                                                                             ^
[0m      | [0;32m                                                                              {
[0m  196 |                                 return 1;[0m
  197 |                         else[0m
      | [0;32m                        } 
[0m[1mfilter.c:197:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  197 |                         else[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m  198 |                                 return 0;[0m
      | [0;1;32m                                         
[0m[1mfilter.c:203:62: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  203 |         if (!(config->filter_opts & FILTER_OPT_DEFAULT_DENY))[0m
      | [0;1;32m                                                             ^
[0m      | [0;32m                                                              {
[0m  204 |                 return 0;[0m
  205 |         else[0m
      | [0;32m        } 
[0m[1mfilter.c:205:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  205 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m  206 |                 return 1;[0m
      | [0;1;32m                         
[0m51 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[21/32][15.5s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpwkrsdtzj.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/log.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mlog.c:124:39: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  124 |                 if (level == LOG_INFO)[0m
      | [0;1;32m                                      ^
[0m      | [0;32m                                       {
[0m  125 |                         return;[0m
      | [0;1;32m                               
[0m[1mlog.c:127:59: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  127 |                 if (level > LOG_INFO && level != LOG_CONN)[0m
      | [0;1;32m                                                          ^
[0m      | [0;32m                                                           {
[0m  128 |                         return;[0m
      | [0;1;32m                               
[0m[1mlog.c:129:38: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  129 |         } else if (level > log_level)[0m
      | [0;1;32m                                     ^
[0m      | [0;32m                                      {
[0m  130 |                 return;[0m
      | [0;1;32m                       
[0m[1mlog.c:133:59: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  133 |         if (config && config->syslog && level == LOG_CONN)[0m
      | [0;1;32m                                                          ^
[0m      | [0;32m                                                           {
[0m  134 |                 level = LOG_INFO;[0m
      | [0;1;32m                                 
[0m[1mlog.c:147:50: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  147 |                         if (!log_message_storage)[0m
      | [0;1;32m                                                 ^
[0m      | [0;32m                                                  {
[0m  148 |                                 goto out;[0m
      | [0;1;32m                                         
[0m[1mlog.c:151:48: [0m[0;1;35mwarning: [0m[1mformat string is not a string literal [clang-diagnostic-format-nonliteral][0m
  151 |                 vsnprintf (str, STRING_LENGTH, fmt, args);[0m
      | [0;1;32m                                               ^~~
[0m[1mlog.c:154:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  154 |                 if (!entry_buffer)[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m  155 |                         goto out;[0m
      | [0;1;32m                                 
[0m[1mlog.c:158:69: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  158 |                 if(!sblist_add (log_message_storage, &entry_buffer))[0m
      | [0;1;32m                                                                    ^
[0m      | [0;32m                                                                     {
[0m  159 |                         safefree (entry_buffer);[0m
      | [0;1;32m                                                
[0m[1mlog.c:163:49: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  163 |         if(!config->syslog && log_file_fd == -1)[0m
      | [0;1;32m                                                ^
[0m      | [0;32m                                                 {
[0m  164 |                 goto out;[0m
      | [0;1;32m                         
[0m[1mlog.c:171:48: [0m[0;1;35mwarning: [0m[1mformat string is not a string literal [clang-diagnostic-format-nonliteral][0m
  171 |                 vsnprintf (str, STRING_LENGTH, fmt, args);[0m
      | [0;1;32m                                               ^~~
[0m[1mlog.c:193:64: [0m[0;1;35mwarning: [0m[1mformat string is not a string literal [clang-diagnostic-format-nonliteral][0m
  193 |                 vsnprintf (p, STRING_LENGTH - strlen(str) - 1, fmt, args);[0m
      | [0;1;32m                                                               ^~~
[0m[1mlog.c:235:41: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  235 |         if (log_message_storage == NULL)[0m
      | [0;1;32m                                        ^
[0m      | [0;32m                                         {
[0m  236 |                 return;[0m
      | [0;1;32m                       
[0m[1mlog.c:242:41: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  242 |                 if (!string || !*string) continue;[0m
      | [0;1;32m                                        ^         
[0m      | [0;32m                                         {
[0m[1mlog.c:248:64: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  248 |                 if (log_level == LOG_CONN && level == LOG_INFO)[0m
      | [0;1;32m                                                               ^
[0m      | [0;32m                                                                {
[0m  249 |                         continue;[0m
  250 |                 else if (log_level == LOG_INFO) {[0m
      | [0;32m                } 
[0m[1mlog.c:251:67: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  251 |                         if (level > LOG_INFO && level != LOG_CONN)[0m
      | [0;1;32m                                                                  ^
[0m      | [0;32m                                                                   {
[0m  252 |                                 continue;[0m
      | [0;1;32m                                         
[0m[1mlog.c:253:46: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  253 |                 } else if (level > log_level)[0m
      | [0;1;32m                                             ^
[0m      | [0;32m                                              {
[0m  254 |                         continue;[0m
      | [0;1;32m                                 
[0m50 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[22/32][16.8s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp7k47aide.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/acl.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1macl.c:78:48: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   78 |         if (init_access_list(access_list) != 0)[0m
      | [0;1;32m                                               ^
[0m      | [0;32m                                                {
[0m   79 |                 return -1;[0m
      | [0;1;32m                          
[0m[1macl.c:86:71: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   86 |         if(hostspec_parse(location, &acl.h) || acl.h.type == HST_NONE)[0m
      | [0;1;32m                                                                      ^
[0m      | [0;32m                                                                       {
[0m   87 |                 return -1;[0m
      | [0;1;32m                          
[0m[1macl.c:89:44: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   89 |         if(!sblist_add(*access_list, &acl)) return -1;[0m
      | [0;1;32m                                           ^          
[0m      | [0;32m                                            {
[0m[1macl.c:123:82: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  123 |                 if (getaddrinfo (acl->h.address.string, NULL, &hints, &res) != 0)[0m
      | [0;1;32m                                                                                 ^
[0m      | [0;32m                                                                                  {
[0m  124 |                         goto STRING_TEST;[0m
      | [0;1;32m                                         
[0m[1macl.c:140:53: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  140 |                         if (acl->access == ACL_DENY)[0m
      | [0;1;32m                                                    ^
[0m      | [0;32m                                                     {
[0m  141 |                                 return 0;[0m
  142 |                         else[0m
      | [0;32m                        } 
[0m[1macl.c:142:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  142 |                         else[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m  143 |                                 return 1;[0m
      | [0;1;32m                                         
[0m[1macl.c:152:80: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  152 |                                 string_addr, HOSTNAME_LENGTH, NULL, 0, 0) != 0)[0m
      | [0;1;32m                                                                               ^
[0m      | [0;32m                                                                                {
[0m  153 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1macl.c:163:40: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  163 |         if (test_length < match_length)[0m
      | [0;1;32m                                       ^
[0m      | [0;32m                                        {
[0m  164 |                 return -1;[0m
      | [0;1;32m                          
[0m[1macl.c:169:45: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  169 |                 if (acl->access == ACL_DENY)[0m
      | [0;1;32m                                            ^
[0m      | [0;32m                                             {
[0m  170 |                         return 0;[0m
  171 |                 else[0m
      | [0;32m                } 
[0m[1macl.c:171:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  171 |                 else[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m  172 |                         return 1;[0m
      | [0;1;32m                                 
[0m[1macl.c:199:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  199 |                 if (x != y)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m  200 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1macl.c:230:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  230 |         if (!access_list)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m  231 |                 return 1;[0m
      | [0;1;32m                         
[0m[1macl.c:239:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  239 |                         perm = acl_string_processing (acl, ip, addr, string_addr);[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  240 |                         break;[0m
      | [0;1;32m                             
[0m      | [0;32m                             ;} 
[0m[1macl.c:243:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  243 |                         if (ip[0] == '\0')[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  244 |                                 continue;[0m
  245 | [0m
  246 |                         perm = is_numeric_addr[0m
  247 |                                ? check_numeric_acl (acl, numeric_addr)[0m
  248 |                                : -1;[0m
  249 |                         break;[0m
      | [0;1;32m                             
[0m      | [0;32m                             ;} 
[0m[1macl.c:243:43: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  243 |                         if (ip[0] == '\0')[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m  244 |                                 continue;[0m
      | [0;1;32m                                         
[0m[1macl.c:252:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  252 |                         perm = -1;[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  253 |                         break;[0m
      | [0;1;32m                             
[0m      | [0;32m                             ;} 
[0m[1macl.c:260:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  260 |                 if (perm == 0)[0m
      | [0;1;32m                              ^
[0m      | [0;32m                               {
[0m  261 |                         break;[0m
  262 |                 else if (perm == 1)[0m
      | [0;32m                } 
[0m[1macl.c:262:36: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  262 |                 else if (perm == 1)[0m
      | [0;1;32m                                   ^
[0m      | [0;32m                                    {
[0m  263 |                         return perm;[0m
      | [0;1;32m                                    
[0m52 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[23/32][23.5s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpycatnrwq.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/network.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mnetwork.c:51:44: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   51 |                         if (errno == EINTR)[0m
      | [0;1;32m                                           ^
[0m      | [0;32m                                            {
[0m   52 |                                 continue;[0m
   53 |                         else[0m
      | [0;32m                        } 
[0m[1mnetwork.c:53:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   53 |                         else[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m   54 |                                 return -errno;[0m
      | [0;1;32m                                              
[0m[1mnetwork.c:57:49: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   57 |                 if ((size_t) len == bytestosend)[0m
      | [0;1;32m                                                ^
[0m      | [0;32m                                                 {
[0m   58 |                         break;[0m
      | [0;1;32m                              
[0m[1mnetwork.c:95:56: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   95 |         if ((buf = (char *) safemalloc (size)) == NULL)[0m
      | [0;1;32m                                                       ^
[0m      | [0;32m                                                        {
[0m   96 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mnetwork.c:100:43: [0m[0;1;35mwarning: [0m[1mformat string is not a string literal [clang-diagnostic-format-nonliteral][0m
  100 |                 n = vsnprintf (buf, size, fmt, ap);[0m
      | [0;1;32m                                          ^~~
[0m[1mnetwork.c:104:49: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  104 |                 if (n > -1 && (size_t) n < size)[0m
      | [0;1;32m                                                ^
[0m      | [0;32m                                                 {
[0m  105 |                         break;[0m
      | [0;1;32m                              
[0m[1mnetwork.c:108:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  108 |                 if (n > -1)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m  109 |                         /* precisely what is needed (glibc2.1) */[0m
  110 |                         size = n + 1;[0m
  111 |                 else[0m
      | [0;32m                } 
[0m[1mnetwork.c:111:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  111 |                 else[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m  112 |                         /* twice the old size (glibc2.0) */[0m
  113 |                         size *= 2;[0m
      | [0;1;32m                                  
[0m[1mnetwork.c:118:23: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  118 |                 } else[0m
      | [0;1;32m                      ^
[0m      | [0;32m                       {
[0m  119 |                         buf = tmpbuf;[0m
      | [0;1;32m                                     
[0m[1mnetwork.c:161:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  161 |         if (!first_line)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  162 |                 return -ENOMEM;[0m
      | [0;1;32m                               
[0m[1mnetwork.c:169:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  169 |                 if (ret <= 0)[0m
      | [0;1;32m                             ^
[0m      | [0;32m                              {
[0m  170 |                         goto CLEANUP;[0m
      | [0;1;32m                                     
[0m[1mnetwork.c:173:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  173 |                 if (ptr)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  174 |                         diff = ptr - buffer + 1;[0m
  175 |                 else[0m
      | [0;32m                } 
[0m[1mnetwork.c:175:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  175 |                 else[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m  176 |                         diff = ret;[0m
      | [0;1;32m                                   
[0m[1mnetwork.c:240:38: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  240 |                 if (first_line->data)[0m
      | [0;1;32m                                     ^
[0m      | [0;32m                                      {
[0m  241 |                         safefree (first_line->data);[0m
      | [0;1;32m                                                    
[0m[1mnetwork.c:265:53: [0m[0;1;35mwarning: [0m[1mcast from 'struct sockaddr *' to 'struct sockaddr_in *' increases required alignment from 2 to 4 [clang-diagnostic-cast-align][0m
  265 |                         struct sockaddr_in *sa_in = (struct sockaddr_in *) sa;[0m
      | [0;1;32m                                                    ^~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mnetwork.c:274:29: [0m[0;1;35mwarning: [0m[1mcast from 'struct sockaddr *' to 'struct sockaddr_in6 *' increases required alignment from 2 to 4 [clang-diagnostic-cast-align][0m
  274 |                             (struct sockaddr_in6 *) sa;[0m
      | [0;1;32m                            ^~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mnetwork.c:282:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  282 |                 return NULL;[0m
      | [0;1;32m                ^          
[0m      | [0;32m                {          ;} 
[0m51 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[24/32][27.1s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpjnjy1eoy.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/reverse-proxy.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mreverse-proxy.c:67:19: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   67 |         if (!path)[0m
      | [0;1;32m                  ^
[0m      | [0;32m                   {
[0m   68 |                 reverse->path = safestrdup ("/");[0m
   69 |         else {[0m
      | [0;32m        } 
[0m[1mreverse-proxy.c:71:43: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   71 |                 if (l && path[l-1] == '/')[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m   72 |                         reverse->path = safestrdup (path);[0m
   73 |                 else {[0m
      | [0;32m                } 
[0m[1mreverse-proxy.c:104:53: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  104 |                     !memcmp(url,  reverse->path, l))[0m
      | [0;1;32m                                                    ^
[0m      | [0;32m                                                     {
[0m  105 |                         return reverse;[0m
      | [0;1;32m                                       
[0m[1mreverse-proxy.c:171:33: [0m[0;1;35mwarning: [0m[1mCall to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy][0m
  171 |                                 strcpy (rewrite_url, reverse->url);[0m
      | [0;1;32m                                ^~~~~~
[0m[1mreverse-proxy.c:171:33: [0m[0;1;36mnote: [0mCall to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119[0m
  171 |                                 strcpy (rewrite_url, reverse->url);[0m
      | [0;1;32m                                ^~~~~~
[0m[1mreverse-proxy.c:172:33: [0m[0;1;35mwarning: [0m[1mCall to function 'strcat' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcat'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy][0m
  172 |                                 strcat (rewrite_url, url + 1);[0m
      | [0;1;32m                                ^~~~~~
[0m[1mreverse-proxy.c:172:33: [0m[0;1;36mnote: [0mCall to function 'strcat' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcat'. CWE-119[0m
  172 |                                 strcat (rewrite_url, url + 1);[0m
      | [0;1;32m                                ^~~~~~
[0m[1mreverse-proxy.c:188:45: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  188 |         if (config->reversemagic && reverse)[0m
      | [0;1;32m                                            ^
[0m      | [0;32m                                             {
[0m  189 |                 connptr->reversepath = safestrdup (reverse->path);[0m
      | [0;1;32m                                                                  
[0m40 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[25/32][35.1s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpisrayra3.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/conns.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mconns.c:54:34: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   54 |         if (!cbuffer || !sbuffer)[0m
      | [0;1;32m                                 ^
[0m      | [0;32m                                  {
[0m   55 |                 goto error_exit;[0m
      | [0;1;32m                                
[0m[1mconns.c:72:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   72 |         if (cbuffer)[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m   73 |                 delete_buffer (cbuffer);[0m
      | [0;1;32m                                        
[0m[1mconns.c:74:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   74 |         if (sbuffer)[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m   75 |                 delete_buffer (sbuffer);[0m
      | [0;1;32m                                        
[0m[1mconns.c:84:38: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   84 |         if (connptr->client_fd != -1)[0m
      | [0;1;32m                                     ^
[0m      | [0;32m                                      {
[0m   85 |                 if (close (connptr->client_fd) < 0)[0m
   86 |                         log_message (LOG_INFO, "Client (%d) close message: %s",[0m
   87 |                                      connptr->client_fd, strerror (errno));[0m
      | [0;1;32m                                                                           
[0m[1mconns.c:85:52: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   85 |                 if (close (connptr->client_fd) < 0)[0m
      | [0;1;32m                                                   ^
[0m      | [0;32m                                                    {
[0m   86 |                         log_message (LOG_INFO, "Client (%d) close message: %s",[0m
   87 |                                      connptr->client_fd, strerror (errno));[0m
      | [0;1;32m                                                                           
[0m[1mconns.c:89:38: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   89 |         if (connptr->server_fd != -1)[0m
      | [0;1;32m                                     ^
[0m      | [0;32m                                      {
[0m   90 |                 if (close (connptr->server_fd) < 0)[0m
   91 |                         log_message (LOG_INFO, "Server (%d) close message: %s",[0m
   92 |                                      connptr->server_fd, strerror (errno));[0m
      | [0;1;32m                                                                           
[0m[1mconns.c:90:52: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   90 |                 if (close (connptr->server_fd) < 0)[0m
      | [0;1;32m                                                   ^
[0m      | [0;32m                                                    {
[0m   91 |                         log_message (LOG_INFO, "Server (%d) close message: %s",[0m
   92 |                                      connptr->server_fd, strerror (errno));[0m
      | [0;1;32m                                                                           
[0m[1mconns.c:95:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   95 |         if (connptr->cbuffer)[0m
      | [0;1;32m                             ^
[0m      | [0;32m                              {
[0m   96 |                 delete_buffer (connptr->cbuffer);[0m
      | [0;1;32m                                                 
[0m[1mconns.c:97:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   97 |         if (connptr->sbuffer)[0m
      | [0;1;32m                             ^
[0m      | [0;32m                              {
[0m   98 |                 delete_buffer (connptr->sbuffer);[0m
      | [0;1;32m                                                 
[0m[1mconns.c:100:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  100 |         if (connptr->request_line)[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m  101 |                 safefree (connptr->request_line);[0m
      | [0;1;32m                                                 
[0m[1mconns.c:114:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  114 |         if (connptr->error_string)[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m  115 |                 safefree (connptr->error_string);[0m
      | [0;1;32m                                                 
[0m[1mconns.c:117:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  117 |         if (connptr->server_ip_addr)[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m  118 |                 safefree (connptr->server_ip_addr);[0m
      | [0;1;32m                                                   
[0m[1mconns.c:119:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  119 |         if (connptr->client_ip_addr)[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m  120 |                 safefree (connptr->client_ip_addr);[0m
      | [0;1;32m                                                   
[0m[1mconns.c:123:34: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  123 |         if (connptr->reversepath)[0m
      | [0;1;32m                                 ^
[0m      | [0;32m                                  {
[0m  124 |                 safefree (connptr->reversepath);[0m
      | [0;1;32m                                                
[0m48 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[26/32][39.7s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp0xjm4v6z.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/hsearch.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mhsearch.c:74:12: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   74 |         while (*p)[0m
      | [0;1;32m                  ^
[0m      | [0;32m                   {
[0m   75 |                 h = 31*h + LOWER_OR_NOT(*p++);[0m
      | [0;1;32m                                              
[0m[1mhsearch.c:88:20: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   88 |         if (nel > MAXSIZE)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m   89 |                 nel = MAXSIZE;[0m
      | [0;1;32m                              
[0m[1mhsearch.c:90:54: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   90 |         for (newsize = MINSIZE; newsize < nel; newsize *= 2);[0m
      | [0;1;32m                                                            ^
[0m      | [0;32m                                                             {
[0m[1mhsearch.c:97:14: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   97 |         if (!oldtab)[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m   98 |                 return 1;[0m
      | [0;1;32m                         
[0m[1mhsearch.c:101:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  101 |         for (e = oldtab; e < oldend; e++)[0m
      | [0;1;32m                                         ^
[0m      | [0;32m                                          {
[0m  102 |                 if (e->item.key) {[0m
  103 |                         for (i=e->hash,j=1; ; i+=j++) {[0m
  104 |                                 newe = htab->elems + (i & htab->mask);[0m
  105 |                                 if (!newe->item.key)[0m
  106 |                                         break;[0m
  107 |                         }[0m
  108 |                         *newe = *e;[0m
  109 |                 }[0m
      | [0;1;32m                 
[0m[1mhsearch.c:105:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  105 |                                 if (!newe->item.key)[0m
      | [0;1;32m                                                    ^
[0m      | [0;32m                                                     {
[0m  106 |                                         break;[0m
      | [0;1;32m                                              
[0m[1mhsearch.c:122:25: [0m[0;1;35mwarning: [0m[1mNull pointer passed to 1st parameter expecting 'nonnull' [clang-analyzer-core.NonNullParamChecker][0m
  122 |                     (e->hash==hash && STRCMP(e->item.key, key)==0))[0m
      | [0;1;32m                                      ^
[0m[1mhsearch.c:63:22: [0m[0;1;36mnote: [0mexpanded from macro 'STRCMP'[0m
   63 | #define STRCMP(X, Y) strcasecmp(X, Y)[0m
      | [0;1;32m                     ^
[0m[1mhsearch.c:185:19: [0m[0;1;36mnote: [0mCalling 'lookup'[0m
  185 |         struct elem *e = lookup(htab, key, hash, 0xdeadc0de);[0m
      | [0;1;32m                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mhsearch.c:119:2: [0m[0;1;36mnote: [0mLoop condition is true.  Entering loop body[0m
  119 |         for (i=hash,j=1; ; i+=j++) {[0m
      | [0;1;32m        ^
[0m[1mhsearch.c:121:8: [0m[0;1;36mnote: [0mAssuming field 'key' is null[0m
  121 |                 if ((!e->item.key && (!e->hash || e->hash == dead)) ||[0m
      | [0;1;32m                     ^~~~~~~~~~~~
[0m[1mhsearch.c:121:8: [0m[0;1;36mnote: [0mAssuming pointer value is null[0m
  121 |                 if ((!e->item.key && (!e->hash || e->hash == dead)) ||[0m
      | [0;1;32m                     ^~~~~~~~~~~~
[0m[1mhsearch.c:121:8: [0m[0;1;36mnote: [0mLeft side of '&&' is true[0m
[1mhsearch.c:121:25: [0m[0;1;36mnote: [0mAssuming field 'hash' is not equal to 0[0m
  121 |                 if ((!e->item.key && (!e->hash || e->hash == dead)) ||[0m
      | [0;1;32m                                      ^~~~~~~~
[0m[1mhsearch.c:121:25: [0m[0;1;36mnote: [0mLeft side of '||' is false[0m
[1mhsearch.c:121:37: [0m[0;1;36mnote: [0mAssuming 'dead' is not equal to field 'hash'[0m
  121 |                 if ((!e->item.key && (!e->hash || e->hash == dead)) ||[0m
      | [0;1;32m                                                  ^~~~~~~~~~~~~~~
[0m[1mhsearch.c:121:7: [0m[0;1;36mnote: [0mLeft side of '||' is false[0m
  121 |                 if ((!e->item.key && (!e->hash || e->hash == dead)) ||[0m
      | [0;1;32m                    ^
[0m[1mhsearch.c:122:8: [0m[0;1;36mnote: [0mAssuming 'hash' is equal to field 'hash'[0m
  122 |                     (e->hash==hash && STRCMP(e->item.key, key)==0))[0m
      | [0;1;32m                     ^~~~~~~~~~~~~
[0m[1mhsearch.c:122:8: [0m[0;1;36mnote: [0mLeft side of '&&' is true[0m
[1mhsearch.c:122:25: [0m[0;1;36mnote: [0mNull pointer passed to 1st parameter expecting 'nonnull'[0m
  122 |                     (e->hash==hash && STRCMP(e->item.key, key)==0))[0m
      | [0;1;32m                                      ^
[0m[1mhsearch.c:63:22: [0m[0;1;36mnote: [0mexpanded from macro 'STRCMP'[0m
   63 | #define STRCMP(X, Y) strcasecmp(X, Y)[0m
      | [0;1;32m                     ^          ~
[0m[1mhsearch.c:122:54: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  122 |                     (e->hash==hash && STRCMP(e->item.key, key)==0))[0m
      | [0;1;32m                                                                   ^
[0m      | [0;32m                                                                    {
[0m  123 |                         break;[0m
      | [0;1;32m                              
[0m[1mhsearch.c:135:10: [0m[0;1;35mwarning: [0m[1mAccess to field 'seed' results in a dereference of a null pointer (loaded from variable 'r') [clang-analyzer-core.NullDereference][0m
  135 |         r->seed = rand();[0m
      | [0;1;32m        ~       ^
[0m[1mhsearch.c:130:2: [0m[0;1;36mnote: [0m'r' initialized here[0m
  130 |         struct htab *r = calloc(1, sizeof *r);[0m
      | [0;1;32m        ^~~~~~~~~~~~~~
[0m[1mhsearch.c:131:5: [0m[0;1;36mnote: [0mAssuming 'r' is null[0m
  131 |         if(r && !resize(r, nel)) {[0m
      | [0;1;32m           ^
[0m[1mhsearch.c:131:7: [0m[0;1;36mnote: [0mLeft side of '&&' is false[0m
  131 |         if(r && !resize(r, nel)) {[0m
      | [0;1;32m             ^
[0m[1mhsearch.c:135:10: [0m[0;1;36mnote: [0mAccess to field 'seed' results in a dereference of a null pointer (loaded from variable 'r')[0m
  135 |         r->seed = rand();[0m
      | [0;1;32m        ~       ^
[0m[1mhsearch.c:159:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  159 |         if(!e) return 0;[0m
      | [0;1;32m              ^         
[0m      | [0;32m               {
[0m[1mhsearch.c:166:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  166 |         if(!e) return 0;[0m
      | [0;1;32m              ^         
[0m      | [0;32m               {
[0m[1mhsearch.c:174:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  174 |         if(!e) return 0;[0m
      | [0;1;32m              ^         
[0m      | [0;32m               {
[0m20 warnings generated.
Suppressed 6 warnings (6 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[27/32][42.9s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpgmx0ozs5.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/child.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mchild.c:72:9: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   72 |                 } else i++;[0m
      | [0;1;32m                      ^    
[0m      | [0;32m                       {
[0m[1mchild.c:109:39: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  109 |                         if (!was_full)[0m
      | [0;1;32m                                      ^
[0m      | [0;32m                                       {
[0m  110 |                                 log_message (LOG_WARNING,[0m
  111 |                                              "Maximum number of connections reached. "[0m
  112 |                                              "Refusing new connections.");[0m
      | [0;1;32m                                                                          
[0m[1mchild.c:228:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  228 |         if (sig != SIGTERM) return;[0m
      | [0;1;32m                           ^       
[0m      | [0;32m                            {
[0m[1mchild.c:238:16: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  238 |                 if (!c->done) pthread_kill(c->thread, SIGCHLD);[0m
      | [0;1;32m                             ^                                 
[0m      | [0;32m                              {
[0m[1mchild.c:242:34: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  242 |         if (sblist_getsize(childs) != 0)[0m
      | [0;1;32m                                        ^
[0m      | [0;32m                                         {
[0m  243 |                 if(tries++ < 8) goto again;[0m
      | [0;1;32m                                           
[0m[1mchild.c:243:18: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  243 |                 if(tries++ < 8) goto again;[0m
      | [0;1;32m                               ^           
[0m      | [0;32m                                {
[0m[1mchild.c:244:34: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  244 |         if (sblist_getsize(childs) != 0)[0m
      | [0;1;32m                                        ^
[0m      | [0;32m                                         {
[0m  245 |                 log_message (LOG_CRIT,[0m
  246 |                              "child_kill_children: %zu threads still alive!",[0m
  247 |                              sblist_getsize(childs)[0m
  248 |                 );[0m
      | [0;1;32m                  
[0m41 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[28/32][84.7s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpbxjugsoj.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/conf.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mconf.c:268:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  268 |         if (!add_headers) return;[0m
      | [0;1;32m                         ^       
[0m      | [0;32m                          {
[0m[1mconf.c:286:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  286 |                         if(s) safefree(*s);[0m
      | [0;1;32m                             ^             
[0m      | [0;32m                              {
[0m[1mconf.c:331:73: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  331 |                 while((it = htab_next(conf->anonymous_map, it, &k, &v)))[0m
      | [0;1;32m                                                                        ^
[0m      | [0;32m                                                                         {
[0m  332 |                        safefree(k);[0m
      | [0;1;32m                                   
[0m[1mconf.c:360:40: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  360 |                 if (!directives[i].cre)[0m
      | [0;1;32m                                       ^
[0m      | [0;32m                                        {
[0m  361 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mconf.c:366:23: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  366 |                 if (r)[0m
      | [0;1;32m                      ^
[0m      | [0;32m                       {
[0m  367 |                         return r;[0m
      | [0;1;32m                                 
[0m[1mconf.c:407:32: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  407 |         if (!directives[i].cre)[0m
      | [0;1;32m                               ^
[0m      | [0;32m                                {
[0m  408 |                 return (*directives[i].handler) (conf, line, lineno, match);[0m
      | [0;1;32m                                                                            
[0m[1mconf.c:411:65: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  411 |             (directives[i].cre, line, RE_MAX_MATCHES, match, 0))[0m
      | [0;1;32m                                                                ^
[0m      | [0;32m                                                                 {
[0m  412 |                 return (*directives[i].handler) (conf, line, lineno, match);[0m
      | [0;1;32m                                                                            
[0m[1mconf.c:426:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  426 |                 if(buffer[0] == '#') continue;[0m
      | [0;1;32m                                    ^         
[0m      | [0;32m                                     {
[0m[1mconf.c:428:23: [0m[0;1;35mwarning: [0m[1mPotential out of bound access to the region with tainted index [clang-analyzer-security.ArrayBound][0m
  428 |                 while(isspace(*p))p++;[0m
      | [0;1;32m                      ^
[0m[1m/usr/include/ctype.h:197:21: [0m[0;1;36mnote: [0mexpanded from macro 'isspace'[0m
  197 | # define isspace(c)     __isctype((c), _ISspace)[0m
      | [0;1;32m                        ^
[0m[1m/usr/include/ctype.h:89:4: [0m[0;1;36mnote: [0mexpanded from macro '__isctype'[0m
   89 |   ((*__ctype_b_loc ())[(int) (c)] & (unsigned short int) type)[0m
      | [0;1;32m   ^
[0m[1mconf.c:500:15: [0m[0;1;36mnote: [0mCalling 'load_config_file'[0m
  500 |         ret = load_config_file (config_fname, conf);[0m
      | [0;1;32m              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:452:23: [0m[0;1;36mnote: [0mTaint originated here[0m
  452 |         config_file = fopen (config_fname, "r");[0m
      | [0;1;32m                      ^~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:452:23: [0m[0;1;36mnote: [0mTaint propagated to the return value[0m
  452 |         config_file = fopen (config_fname, "r");[0m
      | [0;1;32m                      ^~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:452:23: [0m[0;1;36mnote: [0mAssuming that 'fopen' is successful[0m
  452 |         config_file = fopen (config_fname, "r");[0m
      | [0;1;32m                      ^~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:453:14: [0m[0;1;36mnote: [0m'config_file' is non-null[0m
  453 |         if (!config_file) {[0m
      | [0;1;32m             ^~~~~~~~~~~
[0m[1mconf.c:453:9: [0m[0;1;36mnote: [0mTaking false branch[0m
  453 |         if (!config_file) {[0m
      | [0;1;32m        ^
[0m[1mconf.c:460:13: [0m[0;1;36mnote: [0mCalling 'config_parse'[0m
  460 |         if (config_parse (conf, config_file)) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:425:15: [0m[0;1;36mnote: [0mTaint propagated to the 1st argument[0m
  425 |         for (;fgets (buffer, sizeof (buffer), f);++lineno) {[0m
      | [0;1;32m              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:425:9: [0m[0;1;36mnote: [0mLoop condition is true.  Entering loop body[0m
  425 |         for (;fgets (buffer, sizeof (buffer), f);++lineno) {[0m
      | [0;1;32m        ^
[0m[1mconf.c:426:20: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
  426 |                 if(buffer[0] == '#') continue;[0m
      | [0;1;32m                   ^~~~~~~~~~~~~~~~
[0m[1mconf.c:426:17: [0m[0;1;36mnote: [0mTaking false branch[0m
  426 |                 if(buffer[0] == '#') continue;[0m
      | [0;1;32m                ^
[0m[1mconf.c:428:23: [0m[0;1;36mnote: [0mAccess of the region with a tainted index that may be too large[0m
  428 |                 while(isspace(*p))p++;[0m
      | [0;1;32m                      ^
[0m[1m/usr/include/ctype.h:197:21: [0m[0;1;36mnote: [0mexpanded from macro 'isspace'[0m
  197 | # define isspace(c)     __isctype((c), _ISspace)[0m
      | [0;1;32m                        ^~~~~~~~~~~~~~~~~~~~~~~~
[0m[1m/usr/include/ctype.h:89:4: [0m[0;1;36mnote: [0mexpanded from macro '__isctype'[0m
   89 |   ((*__ctype_b_loc ())[(int) (c)] & (unsigned short int) type)[0m
      | [0;1;32m   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:428:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  428 |                 while(isspace(*p))p++;[0m
      | [0;1;32m                                  ^   
[0m      | [0;32m                                   {
[0m[1mconf.c:429:24: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  429 |                 if(!*p) continue;[0m
      | [0;1;32m                       ^         
[0m      | [0;32m                        {
[0m[1mconf.c:431:42: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  431 |                 while(*q && !isspace(*q))q++;[0m
      | [0;1;32m                                         ^   
[0m      | [0;32m                                          {
[0m[1mconf.c:469:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  469 |         if (config_file)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  470 |                 fclose (config_file);[0m
      | [0;1;32m                                     
[0m[1mconf.c:550:16: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  550 |         if (!p)[0m
      | [0;1;32m               ^
[0m      | [0;32m                {
[0m  551 |                 return NULL;[0m
      | [0;1;32m                            
[0m[1mconf.c:562:18: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  562 |         if (!arg)[0m
      | [0;1;32m                 ^
[0m      | [0;32m                  {
[0m  563 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mconf.c:582:60: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  582 |         if (tolower (p[0]) == 'y' || tolower (p[1]) == 'n')[0m
      | [0;1;32m                                                           ^
[0m      | [0;32m                                                            {
[0m  583 |                 return 1;[0m
  584 |         else[0m
      | [0;32m        } 
[0m[1mconf.c:584:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  584 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m  585 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mconf.c:651:18: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  651 |         if (!arg)[0m
      | [0;1;32m                 ^
[0m      | [0;32m                  {
[0m  652 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mconf.c:667:15: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  667 |         if (r)[0m
      | [0;1;32m              ^
[0m      | [0;32m               {
[0m  668 |                 return r;[0m
      | [0;1;32m                         
[0m[1mconf.c:702:15: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  702 |         if (r)[0m
      | [0;1;32m              ^
[0m      | [0;32m               {
[0m  703 |                 return r;[0m
      | [0;1;32m                         
[0m[1mconf.c:730:15: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  730 |         if (r)[0m
      | [0;1;32m              ^
[0m      | [0;32m               {
[0m  731 |                 return r;[0m
      | [0;1;32m                         
[0m[1mconf.c:792:64: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  792 |         if(insert_acl (arg, ACL_ALLOW, &conf->access_list) < 0)[0m
      | [0;1;32m                                                               ^
[0m      | [0;32m                                                                {
[0m  793 |                 warn_invalid_address (arg, lineno);[0m
      | [0;1;32m                                                   
[0m[1mconf.c:802:63: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  802 |         if(insert_acl (arg, ACL_DENY, &conf->access_list) < 0)[0m
      | [0;1;32m                                                              ^
[0m      | [0;32m                                                               {
[0m  803 |                 warn_invalid_address (arg, lineno);[0m
      | [0;1;32m                                                   
[0m[1mconf.c:940:19: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  940 |         if (!user)[0m
      | [0;1;32m                  ^
[0m      | [0;32m                   {
[0m  941 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mconf.c:1009:19: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1009 |         if (!type) return -1;[0m
      | [0;1;32m                  ^          
[0m      | [0;32m                   {
[0m[1mconf.c:1011:54: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1011 |         for(i=0;i<sizeof(ftmap)/sizeof(ftmap[0]);++i)[0m
      | [0;1;32m                                                     ^
[0m      | [0;32m                                                      {
[0m 1012 |                 if(!strcasecmp(ftmap[i].type, type))[0m
 1013 |                         conf->filter_opts |= ftmap[i].flag;[0m
      | [0;1;32m                                                           
[0m[1mconf.c:1012:53: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1012 |                 if(!strcasecmp(ftmap[i].type, type))[0m
      | [0;1;32m                                                    ^
[0m      | [0;32m                                                     {
[0m 1013 |                         conf->filter_opts |= ftmap[i].flag;[0m
      | [0;1;32m                                                           
[0m[1mconf.c:1044:19: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1044 |         if (!arg1)[0m
      | [0;1;32m                  ^
[0m      | [0;32m                   {
[0m 1045 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mconf.c:1075:56: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1075 |         for (i = 0; i < sizeof(pt_map)/sizeof(pt_map[0]); i++)[0m
      | [0;1;32m                                                              ^
[0m      | [0;32m                                                               {
[0m 1076 |                 if (!strcmp(pt_map[i], s))[0m
 1077 |                         return i;[0m
      | [0;1;32m                                 
[0m[1mconf.c:1076:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1076 |                 if (!strcmp(pt_map[i], s))[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m 1077 |                         return i;[0m
      | [0;1;32m                                 
[0m[1mconf.c:1093:50: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1093 |                         if (match[4].rm_so == -1) return -1;[0m
      | [0;1;32m                                                 ^          
[0m      | [0;32m                                                  {
[0m[1mconf.c:1095:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1095 |                         if (!domain)[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m 1096 |                                 return -1;[0m
      | [0;1;32m                                          
[0m[1mconf.c:1106:14: [0m[0;1;35mwarning: [0m[1mPotential leak of memory pointed to by 'tmp' [clang-analyzer-unix.Malloc][0m
 1106 |         pt = pt_from_string(tmp);[0m
      | [0;1;32m             ^
[0m[1mconf.c:1089:13: [0m[0;1;36mnote: [0mAssuming the condition is true[0m
 1089 |         if (match[3].rm_so != -1) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1089:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1089 |         if (match[3].rm_so != -1) {[0m
      | [0;1;32m        ^
[0m[1mconf.c:1090:23: [0m[0;1;36mnote: [0mCalling 'get_string_arg'[0m
 1090 |                 tmp = get_string_arg (line, &match[3]);[0m
      | [0;1;32m                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:549:22: [0m[0;1;36mnote: [0mMemory is allocated[0m
  549 |         p = (char *) safemalloc (len + 1);[0m
      | [0;1;32m                     ^
[0m[1m./heap.h:48:25: [0m[0;1;36mnote: [0mexpanded from macro 'safemalloc'[0m
   48 | #  define safemalloc(x) malloc(x)[0m
      | [0;1;32m                        ^~~~~~~~~
[0m[1mconf.c:550:13: [0m[0;1;36mnote: [0mAssuming 'p' is non-null[0m
  550 |         if (!p)[0m
      | [0;1;32m            ^~
[0m[1mconf.c:550:9: [0m[0;1;36mnote: [0mTaking false branch[0m
  550 |         if (!p)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1090:23: [0m[0;1;36mnote: [0mReturned allocated memory[0m
 1090 |                 tmp = get_string_arg (line, &match[3]);[0m
      | [0;1;32m                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1091:20: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1091 |                 if(!strcmp(tmp, "none")) {[0m
      | [0;1;32m                   ^~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1091:17: [0m[0;1;36mnote: [0mTaking false branch[0m
 1091 |                 if(!strcmp(tmp, "none")) {[0m
      | [0;1;32m                ^
[0m[1mconf.c:1106:14: [0m[0;1;36mnote: [0mPotential leak of memory pointed to by 'tmp'[0m
 1106 |         pt = pt_from_string(tmp);[0m
      | [0;1;32m             ^
[0m[1mconf.c:1110:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1110 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m 1111 |                 user = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                                                         
[0m[1mconf.c:1114:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1114 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m 1115 |                 pass = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                                                         
[0m[1mconf.c:1118:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1118 |         if (match[mi+4].rm_so != -1) /* IPv6 address in square brackets */[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m 1119 |                 ip = get_string_arg (line, &match[mi+4]);[0m
 1120 |         else[0m
      | [0;32m        } 
[0m[1mconf.c:1120:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1120 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m 1121 |                 ip = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                                                       
[0m[1mconf.c:1122:17: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1122 |         if (!ip)[0m
      | [0;1;32m                ^
[0m      | [0;32m                 {
[0m 1123 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mconf.c:1123:25: [0m[0;1;35mwarning: [0m[1mPotential leak of memory pointed to by 'pass' [clang-analyzer-unix.Malloc][0m
 1123 |                 return -1;[0m
      | [0;1;32m                        ^
[0m[1mconf.c:1089:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1089 |         if (match[3].rm_so != -1) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1089:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1089 |         if (match[3].rm_so != -1) {[0m
      | [0;1;32m        ^
[0m[1mconf.c:1110:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1110 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1110:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1110 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1114:6: [0m[0;1;36mnote: [0mAssuming the condition is true[0m
 1114 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1114:2: [0m[0;1;36mnote: [0mTaking true branch[0m
 1114 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1115:24: [0m[0;1;36mnote: [0mCalling 'get_string_arg'[0m
 1115 |                 pass = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:549:22: [0m[0;1;36mnote: [0mMemory is allocated[0m
  549 |         p = (char *) safemalloc (len + 1);[0m
      | [0;1;32m                     ^
[0m[1m./heap.h:48:25: [0m[0;1;36mnote: [0mexpanded from macro 'safemalloc'[0m
   48 | #  define safemalloc(x) malloc(x)[0m
      | [0;1;32m                        ^~~~~~~~~
[0m[1mconf.c:550:13: [0m[0;1;36mnote: [0mAssuming 'p' is non-null[0m
  550 |         if (!p)[0m
      | [0;1;32m            ^~
[0m[1mconf.c:550:9: [0m[0;1;36mnote: [0mTaking false branch[0m
  550 |         if (!p)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1115:24: [0m[0;1;36mnote: [0mReturned allocated memory[0m
 1115 |                 pass = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1118:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1118 |         if (match[mi+4].rm_so != -1) /* IPv6 address in square brackets */[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1118:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1118 |         if (match[mi+4].rm_so != -1) /* IPv6 address in square brackets */[0m
      | [0;1;32m        ^
[0m[1mconf.c:1122:14: [0m[0;1;36mnote: [0m'ip' is null[0m
 1122 |         if (!ip)[0m
      | [0;1;32m             ^~
[0m[1mconf.c:1122:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1122 |         if (!ip)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1123:25: [0m[0;1;36mnote: [0mPotential leak of memory pointed to by 'pass'[0m
 1123 |                 return -1;[0m
      | [0;1;32m                        ^
[0m[1mconf.c:1123:25: [0m[0;1;35mwarning: [0m[1mPotential leak of memory pointed to by 'user' [clang-analyzer-unix.Malloc][0m
 1123 |                 return -1;[0m
      | [0;1;32m                        ^
[0m[1mconf.c:1089:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1089 |         if (match[3].rm_so != -1) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1089:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1089 |         if (match[3].rm_so != -1) {[0m
      | [0;1;32m        ^
[0m[1mconf.c:1110:13: [0m[0;1;36mnote: [0mAssuming the condition is true[0m
 1110 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1110:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1110 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1111:24: [0m[0;1;36mnote: [0mCalling 'get_string_arg'[0m
 1111 |                 user = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:549:22: [0m[0;1;36mnote: [0mMemory is allocated[0m
  549 |         p = (char *) safemalloc (len + 1);[0m
      | [0;1;32m                     ^
[0m[1m./heap.h:48:25: [0m[0;1;36mnote: [0mexpanded from macro 'safemalloc'[0m
   48 | #  define safemalloc(x) malloc(x)[0m
      | [0;1;32m                        ^~~~~~~~~
[0m[1mconf.c:550:13: [0m[0;1;36mnote: [0mAssuming 'p' is non-null[0m
  550 |         if (!p)[0m
      | [0;1;32m            ^~
[0m[1mconf.c:550:9: [0m[0;1;36mnote: [0mTaking false branch[0m
  550 |         if (!p)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1111:24: [0m[0;1;36mnote: [0mReturned allocated memory[0m
 1111 |                 user = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1114:6: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1114 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1114:2: [0m[0;1;36mnote: [0mTaking false branch[0m
 1114 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1118:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1118 |         if (match[mi+4].rm_so != -1) /* IPv6 address in square brackets */[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~
[0m[1mconf.c:1118:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1118 |         if (match[mi+4].rm_so != -1) /* IPv6 address in square brackets */[0m
      | [0;1;32m        ^
[0m[1mconf.c:1122:14: [0m[0;1;36mnote: [0m'ip' is null[0m
 1122 |         if (!ip)[0m
      | [0;1;32m             ^~
[0m[1mconf.c:1122:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1122 |         if (!ip)[0m
      | [0;1;32m        ^
[0m[1mconf.c:1123:25: [0m[0;1;36mnote: [0mPotential leak of memory pointed to by 'user'[0m
 1123 |                 return -1;[0m
      | [0;1;32m                        ^
[0m[1mconf.c:1129:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1129 |         if (match[mi].rm_so != -1)[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m 1130 |                 domain = get_string_arg (line, &match[mi]);[0m
      | [0;1;32m                                                           
[0m[1mconf.c:1140:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1140 |         if(ube != UBE_SUCCESS)[0m
      | [0;1;32m                              ^
[0m      | [0;32m                               {
[0m 1141 |                 CP_WARN("%s", upstream_build_error_string(ube));[0m
      | [0;1;32m                                                                
[0m76 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[29/32][88.6s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp3hk5uaya.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/main.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mmain.c:59:35: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   59 |         if (config == &configs[0]) return &configs[1];[0m
      | [0;1;32m                                  ^                   
[0m      | [0;32m                                   {
[0m[1mmain.c:76:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   76 |                 break;[0m
      | [0;1;32m                ^    
[0m      | [0;32m                {    ;} 
[0m[1mmain.c:81:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   81 |                 break;[0m
      | [0;1;32m                ^    
[0m      | [0;32m                {    ;} 
[0m[1mmain.c:84:17: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   84 |                 while ((pid = waitpid (-1, &status, WNOHANG)) > 0) ;[0m
      | [0;1;32m                ^
[0m      | [0;32m                {
[0m   85 |                 break;[0m
      | [0;1;32m                     
[0m      | [0;32m                     ;} 
[0m[1mmain.c:84:25: [0m[0;1;35mwarning: [0m[1mAlthough the value stored to 'pid' is used in the enclosing expression, the value is never actually read from 'pid' [clang-analyzer-deadcode.DeadStores][0m
   84 |                 while ((pid = waitpid (-1, &status, WNOHANG)) > 0) ;[0m
      | [0;1;32m                        ^     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mmain.c:84:25: [0m[0;1;36mnote: [0mAlthough the value stored to 'pid' is used in the enclosing expression, the value is never actually read from 'pid'[0m
   84 |                 while ((pid = waitpid (-1, &status, WNOHANG)) > 0) ;[0m
      | [0;1;32m                        ^     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mmain.c:84:67: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   84 |                 while ((pid = waitpid (-1, &status, WNOHANG)) > 0) ;[0m
      | [0;1;32m                                                                  ^ 
[0m      | [0;32m                                                                   {
[0m[1mmain.c:149:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  149 |         if (0 == features)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m  150 |                 printf ("    None\n");[0m
      | [0;1;32m                                      
[0m[1mmain.c:162:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  162 |         if (str == NULL)[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m  163 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mmain.c:167:38: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  167 |                 if (!isdigit (*tstr))[0m
      | [0;1;32m                                     ^
[0m      | [0;32m                                      {
[0m  168 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mmain.c:262:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  262 |         if (reload_logging) shutdown_logging ();[0m
      | [0;1;32m                           ^                    
[0m      | [0;32m                            {
[0m[1mmain.c:267:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  267 |                 if(config) free_config (config);[0m
      | [0;1;32m                          ^                     
[0m      | [0;32m                           {
[0m[1mmain.c:273:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  273 |         if (ret != 0)[0m
      | [0;1;32m                     ^
[0m      | [0;32m                      {
[0m  274 |                 log_message (LOG_WARNING, "Reloading config file failed!");[0m
  275 |         else[0m
      | [0;32m        } 
[0m[1mmain.c:275:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  275 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m  276 |                 log_message (LOG_NOTICE, "Reloading config file finished");[0m
      | [0;1;32m                                                                           
[0m[1mmain.c:314:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  314 |                         display_version ();[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  315 |                         exit (EX_OK);[0m
      | [0;1;32m                                    
[0m      | [0;32m                                    ;} 
[0m[1mmain.c:318:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  318 |                         daemonized = FALSE;[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  319 |                         break;[0m
      | [0;1;32m                             
[0m      | [0;32m                             ;} 
[0m[1mmain.c:322:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  322 |                         config_file = optarg;[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  323 |                         break;[0m
      | [0;1;32m                             
[0m      | [0;32m                             ;} 
[0m[1mmain.c:326:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  326 |                         display_usage ();[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  327 |                         exit (EX_OK);[0m
      | [0;1;32m                                    
[0m      | [0;32m                                    ;} 
[0m[1mmain.c:330:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
  330 |                         display_usage ();[0m
      | [0;1;32m                        ^
[0m      | [0;32m                        {
[0m  331 |                         exit (EX_USAGE);[0m
      | [0;1;32m                                       
[0m      | [0;32m                                       ;} 
[0m[1mmain.c:351:66: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  351 |                 if (!config->syslog && config->logf_name == NULL)[0m
      | [0;1;32m                                                                 ^
[0m      | [0;32m                                                                  {
[0m  352 |                         fprintf(stderr, "WARNING: logging deactivated "[0m
  353 |                                 "(can't log to stdout when daemonized)\n");[0m
      | [0;1;32m                                                                           
[0m[1mmain.c:361:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  361 |         if (config->filter)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m  362 |                 filter_init ();[0m
      | [0;1;32m                               
[0m[1mmain.c:382:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  382 |         if (geteuid () == 0)[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m  383 |                 change_user (argv[0]);[0m
  384 |         else[0m
      | [0;32m        } 
[0m[1mmain.c:384:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  384 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m  385 |                 log_message (LOG_INFO,[0m
  386 |                              "Not running as root, so not changing UID/GID.");[0m
      | [0;1;32m                                                                              
[0m[1mmain.c:399:24: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  399 |         if (daemonized) setup_sig (SIGHUP, takesig, "SIGHUP", argv[0]);[0m
      | [0;1;32m                       ^                                               
[0m      | [0;32m                        {
[0m[1mmain.c:425:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  425 |         if (config->filter)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m  426 |                 filter_destroy ();[0m
      | [0;1;32m                                  
[0m58 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[30/32][95.6s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmp8qh443ki.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/html-error.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mhtml-error.c:48:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   48 |         if (!conf->errorpages)[0m
      | [0;1;32m                              ^
[0m      | [0;32m                               {
[0m   49 |                 conf->errorpages = htab_create (ERRPAGES_BUCKETCOUNT);[0m
      | [0;1;32m                                                                      
[0m[1mhtml-error.c:50:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   50 |         if (!conf->errorpages)[0m
      | [0;1;32m                              ^
[0m      | [0;32m                               {
[0m   51 |                 return (-1);[0m
      | [0;1;32m                            
[0m[1mhtml-error.c:56:16: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   56 |         if (!k) return -1;[0m
      | [0;1;32m               ^          
[0m      | [0;32m                {
[0m[1mhtml-error.c:76:33: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   76 |         if (!config->errorpages)[0m
      | [0;1;32m                                ^
[0m      | [0;32m                                 {
[0m   77 |                 return (config->errorpage_undef);[0m
      | [0;1;32m                                                 
[0m[1mhtml-error.c:82:17: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   82 |         if (!hv) return (config->errorpage_undef);[0m
      | [0;1;32m                ^                                 
[0m      | [0;32m                 {
[0m[1mhtml-error.c:100:23: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  100 |                         if(match.rm_so > 0) safe_write(fd, p, match.rm_so);[0m
      | [0;1;32m                                           ^                               
[0m      | [0;32m                                            {
[0m[1mhtml-error.c:107:14: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  107 |                         if(varval) write_message(fd, "%s", varval);[0m
      | [0;1;32m                                  ^
[0m      | [0;32m                                   {
[0m  108 |                         else if(varval && !*varval) write_message(fd, "(unknown)");[0m
      | [0;32m                        } 
[0m[1mhtml-error.c:108:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  108 |                         else if(varval && !*varval) write_message(fd, "(unknown)");[0m
      | [0;1;32m                                                   ^
[0m      | [0;32m                                                    {
[0m  109 |                         else safe_write(fd, p, l);[0m
      | [0;32m                        } 
[0m[1mhtml-error.c:109:8: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  109 |                         else safe_write(fd, p, l);[0m
      | [0;1;32m                            ^                     
[0m      | [0;32m                             {
[0m[1mhtml-error.c:194:32: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  194 |                 if (error_file) log_message (LOG_ERR,[0m
      | [0;1;32m                               ^
[0m      | [0;32m                                {
[0m  195 |                                 "Error opening error file '%s' (%s)",[0m
  196 |                                 error_file, strerror (errno));[0m
      | [0;1;32m                                                              
[0m[1mhtml-error.c:221:39: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  221 |         if (!connptr->error_variables)[0m
      | [0;1;32m                                      ^
[0m      | [0;32m                                       {
[0m  222 |                 if (![0m
  223 |                     (connptr->error_variables =[0m
  224 |                      htab_create (ERRVAR_BUCKETCOUNT)))[0m
  225 |                         return (-1);[0m
      | [0;1;32m                                    
[0m[1mhtml-error.c:224:56: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  224 |                      htab_create (ERRVAR_BUCKETCOUNT)))[0m
      | [0;1;32m                                                       ^
[0m      | [0;32m                                                        {
[0m  225 |                         return (-1);[0m
      | [0;1;32m                                    
[0m[1mhtml-error.c:230:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  230 |         if (!v || !k) goto oom;[0m
      | [0;1;32m                     ^         
[0m      | [0;32m                      {
[0m[1mhtml-error.c:232:64: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  232 |         if(htab_insert (connptr->error_variables, k, HTV_P(v)))[0m
      | [0;1;32m                                                               ^
[0m      | [0;32m                                                                {
[0m  233 |                 return 1;[0m
      | [0;1;32m                         
[0m[1mhtml-error.c:233:24: [0m[0;1;35mwarning: [0m[1mPotential leak of memory pointed to by 'v' [clang-analyzer-unix.Malloc][0m
  233 |                 return 1;[0m
      | [0;1;32m                       ^
[0m[1mhtml-error.c:295:9: [0m[0;1;36mnote: [0mLoop condition is true.  Entering loop body[0m
  295 |         while ((key = va_arg (ap, char *))) {[0m
      | [0;1;32m        ^
[0m[1mhtml-error.c:298:21: [0m[0;1;36mnote: [0mCalling 'add_error_variable'[0m
  298 |                 if (add_error_variable (connptr, key, val) == -1) {[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mhtml-error.c:221:13: [0m[0;1;36mnote: [0mAssuming field 'error_variables' is non-null[0m
  221 |         if (!connptr->error_variables)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mhtml-error.c:221:9: [0m[0;1;36mnote: [0mTaking false branch[0m
  221 |         if (!connptr->error_variables)[0m
      | [0;1;32m        ^
[0m[1mhtml-error.c:228:13: [0m[0;1;36mnote: [0mMemory is allocated[0m
  228 |         v = safestrdup(val);[0m
      | [0;1;32m            ^
[0m[1m./heap.h:51:25: [0m[0;1;36mnote: [0mexpanded from macro 'safestrdup'[0m
   51 | #  define safestrdup(x) strdup(x)[0m
      | [0;1;32m                        ^~~~~~~~~
[0m[1mhtml-error.c:230:13: [0m[0;1;36mnote: [0mAssuming 'v' is non-null[0m
  230 |         if (!v || !k) goto oom;[0m
      | [0;1;32m            ^~
[0m[1mhtml-error.c:230:13: [0m[0;1;36mnote: [0mLeft side of '||' is false[0m
[1mhtml-error.c:230:19: [0m[0;1;36mnote: [0mAssuming 'k' is non-null[0m
  230 |         if (!v || !k) goto oom;[0m
      | [0;1;32m                  ^~
[0m[1mhtml-error.c:230:9: [0m[0;1;36mnote: [0mTaking false branch[0m
  230 |         if (!v || !k) goto oom;[0m
      | [0;1;32m        ^
[0m[1mhtml-error.c:232:12: [0m[0;1;36mnote: [0mAssuming the condition is true[0m
  232 |         if(htab_insert (connptr->error_variables, k, HTV_P(v)))[0m
      | [0;1;32m           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mhtml-error.c:232:9: [0m[0;1;36mnote: [0mTaking true branch[0m
  232 |         if(htab_insert (connptr->error_variables, k, HTV_P(v)))[0m
      | [0;1;32m        ^
[0m[1mhtml-error.c:233:24: [0m[0;1;36mnote: [0mPotential leak of memory pointed to by 'v'[0m
  233 |                 return 1;[0m
      | [0;1;32m                       ^
[0m49 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[31/32][111.4s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpazhkefed.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/sock.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1msock.c:44:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   44 |         if (n == EAI_SYSTEM)[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m   45 |                 return strerror (errno);[0m
   46 |         else[0m
      | [0;32m        } 
[0m[1msock.c:46:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   46 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m   47 |                 return gai_strerror (n);[0m
      | [0;1;32m                                        
[0m[1msock.c:53:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   53 |         case AF_UNSPEC: return "AF_UNSPEC";[0m
      | [0;1;32m                        ^                 
[0m      | [0;32m                        {                 ;} 
[0m[1msock.c:54:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   54 |         case AF_INET:   return "AF_INET";[0m
      | [0;1;32m                        ^               
[0m      | [0;32m                        {               ;} 
[0m[1msock.c:55:25: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
   55 |         case AF_INET6:  return "AF_INET6";[0m
      | [0;1;32m                        ^                
[0m      | [0;32m                        {                ;} 
[0m[1msock.c:90:71: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   90 |                 if (bind (sockfd, res->ai_addr, res->ai_addrlen) == 0)[0m
      | [0;1;32m                                                                      ^
[0m      | [0;32m                                                                       {
[0m   91 |                         break;  /* success */[0m
      | [0;1;32m                                             
[0m[1msock.c:95:25: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
   95 |         if (res == NULL)        /* was not able to bind to any address */[0m
      | [0;1;32m                        ^
[0m      | [0;32m                         {
[0m   96 |                 return -1;[0m
      | [0;1;32m                          
[0m[1msock.c:168:32: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  168 |                 if (sockfd < 0)[0m
      | [0;1;32m                               ^
[0m      | [0;32m                                {
[0m  169 |                         continue;       /* ignore this one */[0m
      | [0;1;32m                                                             
[0m[1msock.c:401:18: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  401 |             NULL)[0m
      | [0;1;32m                 ^
[0m      | [0;32m                  {
[0m  402 |                 return -1;[0m
      | [0;1;32m                          
[0m43 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.

[32/32][114.2s] /home/C00536225/dev/tcc/build/bin/clang-tidy --use-color -checks=readability-braces-around-statements -export-fixes /itch/common/crepos/cu-to-rtu/c/tinyproxy/tidy-fixes/tmpa99r5q1o.yaml -p=/itch/common/crepos/cu-to-rtu/c/tinyproxy /itch/common/crepos/cu-to-rtu/c/tinyproxy/src/reqs.c
[0;1;35mwarning: [0m[1mno such include directory: '/usr/lib/llvm-18/lib/clang/18/include' [clang-diagnostic-missing-include-dirs][0m
[1mreqs.c:131:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  131 |         if (!request)[0m
      | [0;1;32m                     ^
[0m      | [0;32m                      {
[0m  132 |                 return;[0m
      | [0;1;32m                       
[0m[1mreqs.c:137:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  137 |         if (request->host)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m  138 |                 safefree (request->host);[0m
      | [0;1;32m                                         
[0m[1mreqs.c:139:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  139 |         if (request->path)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m  140 |                 safefree (request->path);[0m
      | [0;1;32m                                         
[0m[1mreqs.c:156:46: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  156 |         if ((p = strchr (host, '@')) == NULL)[0m
      | [0;1;32m                                             ^
[0m      | [0;32m                                              {
[0m  157 |                 return;[0m
      | [0;1;32m                       
[0m[1mreqs.c:164:19: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  164 |         while (*p)[0m
      | [0;1;32m                  ^
[0m      | [0;32m                   {
[0m  165 |                 *host++ = *p++;[0m
      | [0;1;32m                               
[0m[1mreqs.c:180:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  180 |         if (ptr1 == NULL)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m  181 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mreqs.c:185:26: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  185 |         if (ptr2 != NULL)[0m
      | [0;1;32m                         ^
[0m      | [0;32m                          {
[0m  186 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mreqs.c:189:45: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  189 |         if (sscanf (ptr1, "%d", &port) != 1)    /* one conversion required */[0m
      | [0;1;32m                                            ^
[0m      | [0;32m                                             {
[0m  190 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mreqs.c:221:46: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  221 |         if (!request->host || !request->path)[0m
      | [0;1;32m                                             ^
[0m      | [0;32m                                              {
[0m  222 |                 goto ERROR_EXIT;[0m
      | [0;1;32m                                
[0m[1mreqs.c:244:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  244 |         if (request->host)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m  245 |                 safefree (request->host);[0m
      | [0;1;32m                                         
[0m[1mreqs.c:246:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  246 |         if (request->path)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m  247 |                 safefree (request->path);[0m
      | [0;1;32m                                         
[0m[1mreqs.c:262:74: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  262 |         if (request->port != HTTP_PORT && request->port != HTTP_PORT_SSL)[0m
      | [0;1;32m                                                                         ^
[0m      | [0;32m                                                                          {
[0m  263 |                 snprintf (portbuff, 7, ":%u", request->port);[0m
  264 |         else[0m
      | [0;32m        } 
[0m[1mreqs.c:264:13: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  264 |         else[0m
      | [0;1;32m            ^
[0m      | [0;32m             {
[0m  265 |                 portbuff[0] = '\0';[0m
      | [0;1;32m                                   
[0m[1mreqs.c:333:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  333 |         if (!request)[0m
      | [0;1;32m                     ^
[0m      | [0;32m                      {
[0m  334 |                 return NULL;[0m
      | [0;1;32m                            
[0m[1mreqs.c:371:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  371 |                 if (ret != 2)[0m
      | [0;1;32m                             ^
[0m      | [0;32m                              {
[0m  372 |                         goto BAD_REQUEST_ERROR;[0m
      | [0;1;32m                                               
[0m[1mreqs.c:458:77: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  458 |                             (connptr, hashofheaders, request, config, &url))[0m
      | [0;1;32m                                                                            ^
[0m      | [0;32m                                                                             {
[0m  459 |                                 goto fail;[0m
      | [0;1;32m                                          
[0m[1mreqs.c:532:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  532 |         if (!buffer)[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m  533 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mreqs.c:538:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  538 |                 if (len <= 0)[0m
      | [0;1;32m                             ^
[0m      | [0;32m                              {
[0m  539 |                         goto ERROR_EXIT;[0m
      | [0;1;32m                                        
[0m[1mreqs.c:542:78: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  542 |                         if (safe_write (connptr->server_fd, buffer, len) < 0)[0m
      | [0;1;32m                                                                             ^
[0m      | [0;32m                                                                              {
[0m  543 |                                 goto ERROR_EXIT;[0m
      | [0;1;32m                                                
[0m[1mreqs.c:571:48: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  571 |                 if (len < 0 && errno != EAGAIN)[0m
      | [0;1;32m                                               ^
[0m      | [0;32m                                                {
[0m  572 |                         goto ERROR_EXIT;[0m
      | [0;1;32m                                        
[0m[1mreqs.c:601:28: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  601 |                 if (buffer) safefree(buffer);[0m
      | [0;1;32m                           ^                 
[0m      | [0;32m                            {
[0m[1mreqs.c:604:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  604 |                 if (len <= 0)[0m
      | [0;1;32m                             ^
[0m      | [0;32m                              {
[0m  605 |                         goto ERROR_EXIT;[0m
      | [0;1;32m                                        
[0m[1mreqs.c:608:78: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  608 |                         if (safe_write (connptr->server_fd, buffer, len) < 0)[0m
      | [0;1;32m                                                                             ^
[0m      | [0;32m                                                                              {
[0m  609 |                                 goto ERROR_EXIT;[0m
      | [0;1;32m                                                
[0m[1mreqs.c:614:67: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  614 |                 if (pull_client_data (connptr, chunklen+2, 0) < 0)[0m
      | [0;1;32m                                                                  ^
[0m      | [0;32m                                                                   {
[0m  615 |                         goto ERROR_EXIT;[0m
      | [0;1;32m                                        
[0m[1mreqs.c:617:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  617 |                 if(!chunklen) break;[0m
      | [0;1;32m                             ^      
[0m      | [0;32m                              {
[0m[1mreqs.c:656:18: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  656 |         if (!sep)[0m
      | [0;1;32m                 ^
[0m      | [0;32m                  {
[0m  657 |                 return 0; /* just skip invalid header, do not give error */[0m
      | [0;1;32m                                                                           
[0m[1mreqs.c:660:59: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  660 |         while (*sep == ':' || *sep == ' ' || *sep == '\t')[0m
      | [0;1;32m                                                          ^
[0m      | [0;32m                                                           {
[0m  661 |                 *sep++ = '\0';[0m
      | [0;1;32m                              
[0m[1mreqs.c:664:9: [0m[0;1;35mwarning: [0m[1mValue stored to 'len' is never read [clang-analyzer-deadcode.DeadStores][0m
  664 |         len -= sep - header - 1;[0m
      | [0;1;32m        ^      ~~~~~~~~~~~~~~~~
[0m[1mreqs.c:664:9: [0m[0;1;36mnote: [0mValue stored to 'len' is never read[0m
  664 |         len -= sep - header - 1;[0m
      | [0;1;32m        ^      ~~~~~~~~~~~~~~~~
[0m[1mreqs.c:788:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  788 |                 if (!data)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m  789 |                         return 0;[0m
      | [0;1;32m                                 
[0m[1mreqs.c:798:72: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  798 |                 while ((ptr = strpbrk (ptr, "()<>@,;:\\\"/[]?={} \t")))[0m
      | [0;1;32m                                                                       ^
[0m      | [0;32m                                                                        {
[0m  799 |                         *ptr++ = '\0';[0m
      | [0;1;32m                                      
[0m[1mreqs.c:810:84: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  810 |                         for (j = 0; j != (sizeof (headers) / sizeof (char *)); ++j)[0m
      | [0;1;32m                                                                                   ^
[0m      | [0;32m                                                                                    {
[0m  811 |                                 if(!strcasecmp(ptr, headers[j])) df = 1;[0m
      | [0;1;32m                                                                        
[0m[1mreqs.c:811:65: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  811 |                                 if(!strcasecmp(ptr, headers[j])) df = 1;[0m
      | [0;1;32m                                                                ^       
[0m      | [0;32m                                                                 {
[0m[1mreqs.c:812:33: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  812 |                         if (!df) orderedmap_remove (hashofheaders, ptr);[0m
      | [0;1;32m                                ^                                       
[0m      | [0;32m                                 {
[0m[1mreqs.c:816:65: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  816 |                         while (ptr < data + len && *ptr == '\0')[0m
      | [0;1;32m                                                                ^
[0m      | [0;32m                                                                 {
[0m  817 |                                 ptr++;[0m
      | [0;1;32m                                      
[0m[1mreqs.c:838:18: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  838 |         if (data)[0m
      | [0;1;32m                 ^
[0m      | [0;32m                  {
[0m  839 |                 content_length = atol (data);[0m
      | [0;1;32m                                             
[0m[1mreqs.c:946:89: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  946 |         if (connptr->content_length.client == -1 && is_chunked_transfer (hashofheaders))[0m
      | [0;1;32m                                                                                        ^
[0m      | [0;32m                                                                                         {
[0m  947 |                 connptr->content_length.client = -2;[0m
      | [0;1;32m                                                    
[0m[1mreqs.c:999:36: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
  999 |         if (config->add_xtinyproxy)[0m
      | [0;1;32m                                   ^
[0m      | [0;32m                                    {
[0m 1000 |                 add_xtinyproxy_header (connptr);[0m
      | [0;1;32m                                                
[0m[1mreqs.c:1004:60: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1004 |         if (safe_write (connptr->server_fd, "\r\n", 2) < 0)[0m
      | [0;1;32m                                                           ^
[0m      | [0;32m                                                            {
[0m 1005 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mreqs.c:1014:57: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1014 |         } else if (connptr->content_length.client == -2)[0m
      | [0;1;32m                                                        ^
[0m      | [0;32m                                                         {
[0m 1015 |                 ret = pull_client_data_chunked (connptr);[0m
      | [0;1;32m                                                         
[0m[1mreqs.c:1049:22: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1049 |         if (len <= 0)[0m
      | [0;1;32m                     ^
[0m      | [0;32m                      {
[0m 1050 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mreqs.c:1104:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1104 |         if (ret < 0)[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m 1105 |                 goto ERROR_EXIT;[0m
      | [0;1;32m                                
[0m[1mreqs.c:1130:21: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1130 |         if (ret < 0)[0m
      | [0;1;32m                    ^
[0m      | [0;32m                     {
[0m 1131 |                 goto ERROR_EXIT;[0m
      | [0;1;32m                                
[0m[1mreqs.c:1139:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1139 |                 if (ret < 0)[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m 1140 |                         goto ERROR_EXIT;[0m
      | [0;1;32m                                        
[0m[1mreqs.c:1152:77: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1152 |                                                                 url))) == 0)[0m
      | [0;1;32m                                                                            ^
[0m      | [0;32m                                                                             {
[0m 1153 |                                 break;[0m
      | [0;1;32m                                      
[0m[1mreqs.c:1163:37: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1163 |                         if (ret < 0)[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m 1164 |                                 goto ERROR_EXIT;[0m
      | [0;1;32m                                                
[0m[1mreqs.c:1183:29: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1183 |                 if (ret < 0)[0m
      | [0;1;32m                            ^
[0m      | [0;32m                             {
[0m 1184 |                         goto ERROR_EXIT;[0m
      | [0;1;32m                                        
[0m[1mreqs.c:1189:60: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1189 |         if (safe_write (connptr->client_fd, "\r\n", 2) < 0)[0m
      | [0;1;32m                                                           ^
[0m      | [0;32m                                                            {
[0m 1190 |                 return -1;[0m
      | [0;1;32m                          
[0m[1mreqs.c:1217:56: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1217 |                 if (buffer_size (connptr->sbuffer) > 0)[0m
      | [0;1;32m                                                       ^
[0m      | [0;32m                                                        {
[0m 1218 |                         fds[0].events |= MYPOLL_WRITE;[0m
      | [0;1;32m                                                      
[0m[1mreqs.c:1219:56: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1219 |                 if (buffer_size (connptr->cbuffer) > 0)[0m
      | [0;1;32m                                                       ^
[0m      | [0;32m                                                        {
[0m 1220 |                         fds[1].events |= MYPOLL_WRITE;[0m
      | [0;1;32m                                                      
[0m[1mreqs.c:1221:66: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1221 |                 if (buffer_size (connptr->sbuffer) < MAXBUFFSIZE)[0m
      | [0;1;32m                                                                 ^
[0m      | [0;32m                                                                  {
[0m 1222 |                         fds[1].events |= MYPOLL_READ;[0m
      | [0;1;32m                                                     
[0m[1mreqs.c:1223:66: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1223 |                 if (buffer_size (connptr->cbuffer) < MAXBUFFSIZE)[0m
      | [0;1;32m                                                                 ^
[0m      | [0;32m                                                                  {
[0m 1224 |                         fds[0].events |= MYPOLL_READ;[0m
      | [0;1;32m                                                     
[0m[1mreqs.c:1244:48: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1244 |                         if (bytes_received < 0)[0m
      | [0;1;32m                                               ^
[0m      | [0;32m                                                {
[0m 1245 |                                 break;[0m
      | [0;1;32m                                      
[0m[1mreqs.c:1248:65: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1248 |                         if (connptr->content_length.server == 0)[0m
      | [0;1;32m                                                                ^
[0m      | [0;32m                                                                 {
[0m 1249 |                                 break;[0m
      | [0;1;32m                                      
[0m[1mreqs.c:1266:77: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1266 |                 if (write_buffer (connptr->client_fd, connptr->sbuffer) < 0)[0m
      | [0;1;32m                                                                            ^
[0m      | [0;32m                                                                             {
[0m 1267 |                         break;[0m
      | [0;1;32m                              
[0m[1mreqs.c:1283:77: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1283 |                 if (write_buffer (connptr->server_fd, connptr->cbuffer) < 0)[0m
      | [0;1;32m                                                                            ^
[0m      | [0;32m                                                                             {
[0m 1284 |                         break;[0m
      | [0;1;32m                              
[0m[1mreqs.c:1317:14: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1317 |                 if(len>255)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m 1318 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1320:64: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1320 |                 if (9+len+1 != safe_write(connptr->server_fd, buff, 9+len+1))[0m
      | [0;1;32m                                                                             ^
[0m      | [0;32m                                                                              {
[0m 1321 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1322:51: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1322 |                 if (8 != safe_read(connptr->server_fd, buff, 8))[0m
      | [0;1;32m                                                                ^
[0m      | [0;32m                                                                 {
[0m 1323 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1324:33: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1324 |                 if (buff[0]!=0 || buff[1]!=90)[0m
      | [0;1;32m                                              ^
[0m      | [0;32m                                               {
[0m 1325 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1334:12: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1334 |                 if (ulen) buff[3] = 2;  /* auth method -> username / password */[0m
      | [0;1;32m                         ^                                                      
[0m      | [0;32m                          {
[0m[1mreqs.c:1335:72: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1335 |                 if (2+n_methods != safe_write(connptr->server_fd, buff, 2+n_methods))[0m
      | [0;1;32m                                                                                     ^
[0m      | [0;32m                                                                                      {
[0m 1336 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1337:51: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1337 |                 if (2 != safe_read(connptr->server_fd, buff, 2))[0m
      | [0;1;32m                                                                ^
[0m      | [0;32m                                                                 {
[0m 1338 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1339:54: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                                                                   ^
[0m      | [0;32m                                                                    {
[0m 1340 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1351:4: [0m[0;1;35mwarning: [0m[1mNull pointer passed to 2nd parameter expecting 'nonnull' [clang-analyzer-core.NonNullParamChecker][0m
 1351 |                         memcpy(cur, cur_upstream->ua.user, c);[0m
      | [0;1;32m                        ^
[0m[1mreqs.c:1592:13: [0m[0;1;36mnote: [0mAssuming field 'bindsame' is 0[0m
 1592 |         if (config->bindsame)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~
[0m[1mreqs.c:1592:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1592 |         if (config->bindsame)[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1595:40: [0m[0;1;36mnote: [0mField 'bindsame' is 0[0m
 1595 |         log_message (LOG_CONN, config->bindsame ?[0m
      | [0;1;32m                                       ^
[0m[1mreqs.c:1595:32: [0m[0;1;36mnote: [0m'?' condition is false[0m
 1595 |         log_message (LOG_CONN, config->bindsame ?[0m
      | [0;1;32m                               ^
[0m[1mreqs.c:1601:44: [0m[0;1;36mnote: [0mField 'bindsame' is 0[0m
 1601 |                                    config->bindsame ? sock_ipaddr : NULL)) {[0m
      | [0;1;32m                                           ^
[0m[1mreqs.c:1601:36: [0m[0;1;36mnote: [0m'?' condition is false[0m
 1601 |                                    config->bindsame ? sock_ipaddr : NULL)) {[0m
      | [0;1;32m                                   ^
[0m[1mreqs.c:1600:12: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1600 |         if(!conn_init_contents (connptr, peer_ipaddr,[0m
      | [0;1;32m           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m 1601 |                                    config->bindsame ? sock_ipaddr : NULL)) {[0m
      | [0;1;32m                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1600:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1600 |         if(!conn_init_contents (connptr, peer_ipaddr,[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1608:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1608 |         if (connection_loops (addr))  {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1608:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1608 |         if (connection_loops (addr))  {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1622:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1622 |         if (check_acl (peer_ipaddr, addr, config->access_list) <= 0) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1622:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1622 |         if (check_acl (peer_ipaddr, addr, config->access_list) <= 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1632:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1632 |         if (read_request_line (connptr) < 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1641:13: [0m[0;1;36mnote: [0mAssuming 'hashofheaders' is not equal to NULL[0m
 1641 |         if (hashofheaders == NULL) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1641:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1641 |         if (hashofheaders == NULL) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1654:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1654 |         if (get_all_headers (connptr->client_fd, hashofheaders) < 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1666:13: [0m[0;1;36mnote: [0mAssuming field 'basicauth_list' is equal to NULL[0m
 1666 |         if (config->basicauth_list != NULL) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1666:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1666 |         if (config->basicauth_list != NULL) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1714:13: [0m[0;1;36mnote: [0mAssuming field 'add_headers' is null[0m
 1714 |         if (config->add_headers)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1714:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1714 |         if (config->add_headers)[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1722:14: [0m[0;1;36mnote: [0m'request' is non-null[0m
 1722 |         if (!request) {[0m
      | [0;1;32m             ^~~~~~~
[0m[1mreqs.c:1722:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1722 |         if (!request) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1730:13: [0m[0;1;36mnote: [0mAssuming field 'upstream_proxy' is not equal to NULL[0m
 1730 |         if (connptr->upstream_proxy != NULL) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1730:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1730 |         if (connptr->upstream_proxy != NULL) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1731:21: [0m[0;1;36mnote: [0mCalling 'connect_to_upstream'[0m
 1731 |                 if (connect_to_upstream (connptr, request) < 0) {[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1426:14: [0m[0;1;36mnote: [0m'cur_upstream' is non-null[0m
 1426 |         if (!cur_upstream) {[0m
      | [0;1;32m             ^~~~~~~~~~~~
[0m[1mreqs.c:1426:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1426 |         if (!cur_upstream) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1439:13: [0m[0;1;36mnote: [0mAssuming field 'server_fd' is >= 0[0m
 1439 |         if (connptr->server_fd < 0) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1439:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1439 |         if (connptr->server_fd < 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1451:6: [0m[0;1;36mnote: [0mAssuming field 'type' is not equal to PT_HTTP[0m
 1451 |         if (cur_upstream->type != PT_HTTP)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1451:2: [0m[0;1;36mnote: [0mTaking true branch[0m
 1451 |         if (cur_upstream->type != PT_HTTP)[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1452:10: [0m[0;1;36mnote: [0mCalling 'connect_to_upstream_proxy'[0m
 1452 |                 return connect_to_upstream_proxy(connptr, request);[0m
      | [0;1;32m                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1300:9: [0m[0;1;36mnote: [0mAssuming field 'user' is null[0m
 1300 |         ulen = cur_upstream->ua.user ? strlen(cur_upstream->ua.user) : 0;[0m
      | [0;1;32m               ^~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1300:9: [0m[0;1;36mnote: [0m'?' condition is false[0m
[1mreqs.c:1301:12: [0m[0;1;36mnote: [0mAssuming field 'pass' is null[0m
 1301 |         passlen = cur_upstream->pass ? strlen(cur_upstream->pass) : 0;[0m
      | [0;1;32m                  ^~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1301:12: [0m[0;1;36mnote: [0m'?' condition is false[0m
[1mreqs.c:1308:6: [0m[0;1;36mnote: [0mAssuming field 'type' is not equal to PT_SOCKS4[0m
 1308 |         if (cur_upstream->type == PT_SOCKS4) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1308:2: [0m[0;1;36mnote: [0mTaking false branch[0m
 1308 |         if (cur_upstream->type == PT_SOCKS4) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1327:13: [0m[0;1;36mnote: [0mAssuming field 'type' is equal to PT_SOCKS5[0m
 1327 |         } else if (cur_upstream->type == PT_SOCKS5) {[0m
      | [0;1;32m                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1327:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1327 |         } else if (cur_upstream->type == PT_SOCKS5) {[0m
      | [0;1;32m               ^
[0m[1mreqs.c:1330:19: [0m[0;1;36mnote: [0m'ulen' is 0[0m
 1330 |                 int n_methods = ulen ? 2 : 1;[0m
      | [0;1;32m                                ^~~~
[0m[1mreqs.c:1330:19: [0m[0;1;36mnote: [0m'?' condition is false[0m
[1mreqs.c:1334:7: [0m[0;1;36mnote: [0m'ulen' is 0[0m
 1334 |                 if (ulen) buff[3] = 2;  /* auth method -> username / password */[0m
      | [0;1;32m                    ^~~~
[0m[1mreqs.c:1334:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1334 |                 if (ulen) buff[3] = 2;  /* auth method -> username / password */[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1335:7: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1335 |                 if (2+n_methods != safe_write(connptr->server_fd, buff, 2+n_methods))[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1335:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1335 |                 if (2+n_methods != safe_write(connptr->server_fd, buff, 2+n_methods))[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1337:7: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1337 |                 if (2 != safe_read(connptr->server_fd, buff, 2))[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1337:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1337 |                 if (2 != safe_read(connptr->server_fd, buff, 2))[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1339:7: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                    ^~~~~~~~~~~~
[0m[1mreqs.c:1339:7: [0m[0;1;36mnote: [0mLeft side of '||' is false[0m
[1mreqs.c:1339:24: [0m[0;1;36mnote: [0mAssuming the condition is true[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                                     ^~~~~~~~~~~~
[0m[1mreqs.c:1339:24: [0m[0;1;36mnote: [0mLeft side of '&&' is true[0m
[1mreqs.c:1339:40: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                                                     ^~~~~~~~~~~~
[0m[1mreqs.c:1339:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1342:3: [0m[0;1;36mnote: [0mTaking true branch[0m
 1342 |                 if (buff[1] == 2) {[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1351:4: [0m[0;1;36mnote: [0mNull pointer passed to 2nd parameter expecting 'nonnull'[0m
 1351 |                         memcpy(cur, cur_upstream->ua.user, c);[0m
      | [0;1;32m                        ^           ~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1355:4: [0m[0;1;35mwarning: [0m[1mNull pointer passed to 2nd parameter expecting 'nonnull' [clang-analyzer-core.NonNullParamChecker][0m
 1355 |                         memcpy(cur, cur_upstream->pass, c);[0m
      | [0;1;32m                        ^
[0m[1mreqs.c:1592:13: [0m[0;1;36mnote: [0mAssuming field 'bindsame' is 0[0m
 1592 |         if (config->bindsame)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~
[0m[1mreqs.c:1592:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1592 |         if (config->bindsame)[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1595:40: [0m[0;1;36mnote: [0mField 'bindsame' is 0[0m
 1595 |         log_message (LOG_CONN, config->bindsame ?[0m
      | [0;1;32m                                       ^
[0m[1mreqs.c:1595:32: [0m[0;1;36mnote: [0m'?' condition is false[0m
 1595 |         log_message (LOG_CONN, config->bindsame ?[0m
      | [0;1;32m                               ^
[0m[1mreqs.c:1601:44: [0m[0;1;36mnote: [0mField 'bindsame' is 0[0m
 1601 |                                    config->bindsame ? sock_ipaddr : NULL)) {[0m
      | [0;1;32m                                           ^
[0m[1mreqs.c:1601:36: [0m[0;1;36mnote: [0m'?' condition is false[0m
 1601 |                                    config->bindsame ? sock_ipaddr : NULL)) {[0m
      | [0;1;32m                                   ^
[0m[1mreqs.c:1600:12: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1600 |         if(!conn_init_contents (connptr, peer_ipaddr,[0m
      | [0;1;32m           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m 1601 |                                    config->bindsame ? sock_ipaddr : NULL)) {[0m
      | [0;1;32m                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1600:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1600 |         if(!conn_init_contents (connptr, peer_ipaddr,[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1608:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1608 |         if (connection_loops (addr))  {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1608:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1608 |         if (connection_loops (addr))  {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1622:13: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1622 |         if (check_acl (peer_ipaddr, addr, config->access_list) <= 0) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1622:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1622 |         if (check_acl (peer_ipaddr, addr, config->access_list) <= 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1632:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1632 |         if (read_request_line (connptr) < 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1641:13: [0m[0;1;36mnote: [0mAssuming 'hashofheaders' is not equal to NULL[0m
 1641 |         if (hashofheaders == NULL) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1641:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1641 |         if (hashofheaders == NULL) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1654:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1654 |         if (get_all_headers (connptr->client_fd, hashofheaders) < 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1666:13: [0m[0;1;36mnote: [0mAssuming field 'basicauth_list' is equal to NULL[0m
 1666 |         if (config->basicauth_list != NULL) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1666:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1666 |         if (config->basicauth_list != NULL) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1714:13: [0m[0;1;36mnote: [0mAssuming field 'add_headers' is null[0m
 1714 |         if (config->add_headers)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1714:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1714 |         if (config->add_headers)[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1722:14: [0m[0;1;36mnote: [0m'request' is non-null[0m
 1722 |         if (!request) {[0m
      | [0;1;32m             ^~~~~~~
[0m[1mreqs.c:1722:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1722 |         if (!request) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1730:13: [0m[0;1;36mnote: [0mAssuming field 'upstream_proxy' is not equal to NULL[0m
 1730 |         if (connptr->upstream_proxy != NULL) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1730:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1730 |         if (connptr->upstream_proxy != NULL) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1731:21: [0m[0;1;36mnote: [0mCalling 'connect_to_upstream'[0m
 1731 |                 if (connect_to_upstream (connptr, request) < 0) {[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1426:14: [0m[0;1;36mnote: [0m'cur_upstream' is non-null[0m
 1426 |         if (!cur_upstream) {[0m
      | [0;1;32m             ^~~~~~~~~~~~
[0m[1mreqs.c:1426:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1426 |         if (!cur_upstream) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1439:13: [0m[0;1;36mnote: [0mAssuming field 'server_fd' is >= 0[0m
 1439 |         if (connptr->server_fd < 0) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1439:9: [0m[0;1;36mnote: [0mTaking false branch[0m
 1439 |         if (connptr->server_fd < 0) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1451:6: [0m[0;1;36mnote: [0mAssuming field 'type' is not equal to PT_HTTP[0m
 1451 |         if (cur_upstream->type != PT_HTTP)[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1451:2: [0m[0;1;36mnote: [0mTaking true branch[0m
 1451 |         if (cur_upstream->type != PT_HTTP)[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1452:10: [0m[0;1;36mnote: [0mCalling 'connect_to_upstream_proxy'[0m
 1452 |                 return connect_to_upstream_proxy(connptr, request);[0m
      | [0;1;32m                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1300:9: [0m[0;1;36mnote: [0mAssuming field 'user' is non-null[0m
 1300 |         ulen = cur_upstream->ua.user ? strlen(cur_upstream->ua.user) : 0;[0m
      | [0;1;32m               ^~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1300:9: [0m[0;1;36mnote: [0m'?' condition is true[0m
[1mreqs.c:1301:12: [0m[0;1;36mnote: [0mAssuming field 'pass' is null[0m
 1301 |         passlen = cur_upstream->pass ? strlen(cur_upstream->pass) : 0;[0m
      | [0;1;32m                  ^~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1301:12: [0m[0;1;36mnote: [0m'?' condition is false[0m
[1mreqs.c:1308:6: [0m[0;1;36mnote: [0mAssuming field 'type' is not equal to PT_SOCKS4[0m
 1308 |         if (cur_upstream->type == PT_SOCKS4) {[0m
      | [0;1;32m            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1308:2: [0m[0;1;36mnote: [0mTaking false branch[0m
 1308 |         if (cur_upstream->type == PT_SOCKS4) {[0m
      | [0;1;32m        ^
[0m[1mreqs.c:1327:13: [0m[0;1;36mnote: [0mAssuming field 'type' is equal to PT_SOCKS5[0m
 1327 |         } else if (cur_upstream->type == PT_SOCKS5) {[0m
      | [0;1;32m                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1327:9: [0m[0;1;36mnote: [0mTaking true branch[0m
 1327 |         } else if (cur_upstream->type == PT_SOCKS5) {[0m
      | [0;1;32m               ^
[0m[1mreqs.c:1330:19: [0m[0;1;36mnote: [0mAssuming 'ulen' is 0[0m
 1330 |                 int n_methods = ulen ? 2 : 1;[0m
      | [0;1;32m                                ^~~~
[0m[1mreqs.c:1330:19: [0m[0;1;36mnote: [0m'?' condition is false[0m
[1mreqs.c:1334:7: [0m[0;1;36mnote: [0m'ulen' is 0[0m
 1334 |                 if (ulen) buff[3] = 2;  /* auth method -> username / password */[0m
      | [0;1;32m                    ^~~~
[0m[1mreqs.c:1334:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1334 |                 if (ulen) buff[3] = 2;  /* auth method -> username / password */[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1335:7: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1335 |                 if (2+n_methods != safe_write(connptr->server_fd, buff, 2+n_methods))[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1335:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1335 |                 if (2+n_methods != safe_write(connptr->server_fd, buff, 2+n_methods))[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1337:7: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1337 |                 if (2 != safe_read(connptr->server_fd, buff, 2))[0m
      | [0;1;32m                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1337:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1337 |                 if (2 != safe_read(connptr->server_fd, buff, 2))[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1339:7: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                    ^~~~~~~~~~~~
[0m[1mreqs.c:1339:7: [0m[0;1;36mnote: [0mLeft side of '||' is false[0m
[1mreqs.c:1339:24: [0m[0;1;36mnote: [0mAssuming the condition is true[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                                     ^~~~~~~~~~~~
[0m[1mreqs.c:1339:24: [0m[0;1;36mnote: [0mLeft side of '&&' is true[0m
[1mreqs.c:1339:40: [0m[0;1;36mnote: [0mAssuming the condition is false[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                                                     ^~~~~~~~~~~~
[0m[1mreqs.c:1339:3: [0m[0;1;36mnote: [0mTaking false branch[0m
 1339 |                 if (buff[0] != 5 || (buff[1] != 0 && buff[1] != 2))[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1342:3: [0m[0;1;36mnote: [0mTaking true branch[0m
 1342 |                 if (buff[1] == 2) {[0m
      | [0;1;32m                ^
[0m[1mreqs.c:1355:4: [0m[0;1;36mnote: [0mNull pointer passed to 2nd parameter expecting 'nonnull'[0m
 1355 |                         memcpy(cur, cur_upstream->pass, c);[0m
      | [0;1;32m                        ^           ~~~~~~~~~~~~~~~~~~
[0m[1mreqs.c:1358:69: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1358 |                         if((cur - out) != safe_write(connptr->server_fd, out, cur - out))[0m
      | [0;1;32m                                                                                         ^
[0m      | [0;32m                                                                                          {
[0m 1359 |                                 return -1;[0m
      | [0;1;32m                                          
[0m[1mreqs.c:1361:49: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1361 |                         if(2 != safe_read(connptr->server_fd, in, 2))[0m
      | [0;1;32m                                                                     ^
[0m      | [0;32m                                                                      {
[0m 1362 |                                 return -1;[0m
      | [0;1;32m                                          
[0m[1mreqs.c:1373:14: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1373 |                 if(len>255)[0m
      | [0;1;32m                           ^
[0m      | [0;32m                            {
[0m 1374 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1379:60: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1379 |                 if (7+len != safe_write(connptr->server_fd, buff, 7+len))[0m
      | [0;1;32m                                                                         ^
[0m      | [0;32m                                                                          {
[0m 1380 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1381:51: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1381 |                 if (4 != safe_read(connptr->server_fd, buff, 4))[0m
      | [0;1;32m                                                                ^
[0m      | [0;32m                                                                 {
[0m 1382 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1383:32: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1383 |                 if (buff[0]!=5 || buff[1]!=0)[0m
      | [0;1;32m                                             ^
[0m      | [0;32m                                              {
[0m 1384 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1386:12: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
 1386 |                         case 1: len=4; break; /* ip v4 */[0m
      | [0;1;32m                                ^           
[0m      | [0;32m                                {           ;} 
[0m[1mreqs.c:1387:12: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
 1387 |                         case 4: len=16; break; /* ip v6 */[0m
      | [0;1;32m                                ^            
[0m      | [0;32m                                {            ;} 
[0m[1mreqs.c:1389:5: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
 1389 |                                 if (1 != safe_read(connptr->server_fd, buff, 1))[0m
      | [0;1;32m                                ^
[0m      | [0;32m                                {
[0m 1390 |                                         return -1;[0m
 1391 |                                 len = buff[0]; /* max = 255 */[0m
 1392 |                                 break;[0m
      | [0;1;32m                                     
[0m      | [0;32m                                     ;} 
[0m[1mreqs.c:1389:53: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1389 |                                 if (1 != safe_read(connptr->server_fd, buff, 1))[0m
      | [0;1;32m                                                                                ^
[0m      | [0;32m                                                                                 {
[0m 1390 |                                         return -1;[0m
      | [0;1;32m                                                  
[0m[1mreqs.c:1393:13: [0m[0;1;35mwarning: [0m[1mcase statement body should be in braces [readability-braces-around-statements][0m
 1393 |                         default: return -1;[0m
      | [0;1;32m                                 ^        
[0m      | [0;32m                                 {        ;} 
[0m[1mreqs.c:1395:59: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1395 |                 if (2+len != safe_read(connptr->server_fd, buff, 2+len))[0m
      | [0;1;32m                                                                        ^
[0m      | [0;32m                                                                         {
[0m 1396 |                         return -1;[0m
      | [0;1;32m                                  
[0m[1mreqs.c:1401:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1401 |         if (connptr->connect_method)[0m
      | [0;1;32m                                    ^
[0m      | [0;32m                                     {
[0m 1402 |                 return 0;[0m
      | [0;1;32m                         
[0m[1mreqs.c:1451:36: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1451 |         if (cur_upstream->type != PT_HTTP)[0m
      | [0;1;32m                                          ^
[0m      | [0;32m                                           {
[0m 1452 |                 return connect_to_upstream_proxy(connptr, request);[0m
      | [0;1;32m                                                                   
[0m[1mreqs.c:1485:27: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1485 |         if (request->path)[0m
      | [0;1;32m                          ^
[0m      | [0;32m                           {
[0m 1486 |                 safefree (request->path);[0m
      | [0;1;32m                                         
[0m[1mreqs.c:1592:30: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1592 |         if (config->bindsame)[0m
      | [0;1;32m                             ^
[0m      | [0;32m                              {
[0m 1593 |                 getsock_ip (fd, sock_ipaddr);[0m
      | [0;1;32m                                             
[0m[1mreqs.c:1676:31: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1676 |                         } else authstring = 0;[0m
      | [0;1;32m                              ^               
[0m      | [0;32m                               {
[0m[1mreqs.c:1680:46: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1680 |                         if (stathost_connect) goto e401;[0m
      | [0;1;32m                                             ^          
[0m      | [0;32m                                              {
[0m[1mreqs.c:1691:87: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1691 |                         basicauth_check (config->basicauth_list, authstring + 6) == 1)[0m
      | [0;1;32m                                                                                      ^
[0m      | [0;32m                                                                                       {
[0m 1692 |                                 failure = 0;[0m
      | [0;1;32m                                            
[0m[1mreqs.c:1714:33: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1714 |         if (config->add_headers)[0m
      | [0;1;32m                                ^
[0m      | [0;32m                                 {
[0m 1715 |         for (i = 0; i < sblist_getsize (config->add_headers); i++) {[0m
 1716 |                 http_header_t *header = sblist_get (config->add_headers, i);[0m
 1717 | [0m
 1718 |                 orderedmap_append (hashofheaders, header->name, header->value);[0m
 1719 |         }[0m
      | [0;1;32m         
[0m[1mreqs.c:1751:46: [0m[0;1;35mwarning: [0m[1mstatement should be inside braces [readability-braces-around-statements][0m
 1751 |                 if (!connptr->connect_method)[0m
      | [0;1;32m                                             ^
[0m      | [0;32m                                              {
[0m 1752 |                         establish_http_connection (connptr, request);[0m
      | [0;1;32m                                                                     
[0m120 warnings generated.
Suppressed 32 warnings (32 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.



Process exited with return code 0
